/* * Movable Type (r) Open Source (C) 2001-2013 Six Apart, Ltd. * This program is distributed under the terms of the * GNU General Public License, version 2. * * $Id$ */(function(d){d.mtAddEdgeClass=function(){d("body *").filter(":first-child").addClass("first-child").end().filter(":last-child").addClass("last-child")};d.mtMenu=function(g){var i={arrow_image:StaticURI+"images/arrow/arrow-toggle-big.png"};var h=d.extend(i,g);d(".top-menu > div a").after('<a href="#" class="toggle-button"><img src="'+h.arrow_image+'" /></a>');d(".top-menu .toggle-button").mousedown(function(j){d(this).parents("li.top-menu").toggleClass("top-menu-open active");d(this).parents("li.top-menu").find(".sub-menu").toggle();return false}).click(function(j){return false})};d.mtSelector=function(g){var i={arrow_image:StaticURI+"images/arrow/arrow-toggle.png"};var h=d.extend(i,g);d("#selector-nav").prepend('<a hre="#" class="toggle-button"><img src="'+h.arrow_image+'" /></a>');d("#selector-nav .toggle-button ").mousedown(function(j){d(this).parent("#selector-nav").toggleClass("show-selector active");return false}).click(function(j){return false});d(document).mousedown(function(j){if(d(j.target).parents("#selector-nav").length==0){d("#selector-nav").removeClass("show-selector active")}});if(!d.support.style&&!d.support.objectAll){if(d.fn.bgiframe){d("div.selector").bgiframe()}}};d.mtUseSubdomain=function(g){var h=d(".url-field :checkbox");h.each(function(){if(!this.checked){d(this).parents(".field-content").find(".subdomain").hide()}});h.click(function(){if(this.checked){d(this).attr("checked",true).parents(".field-content").find(".subdomain").show()}else{d(this).removeAttr("checked").parents(".field-content").find(".subdomain").hide()}})};d.mtEditSiteUrl=function(g){var j={edit:"Edit"};var i=d.extend(j,g);var h=["site","archive"];d.each(h,function(){var n=this;var k=d("input#"+this+"_url_subdomain");var l=d("input#"+this+"_url_path");var m=k.val();if(m){k.parent(".subdomain").before('<span class="'+this+'_url_subdomain-text path-text"></span>');d("span."+this+"_url_subdomain-text").text(k.val()+".")}if(!l.hasClass("show-input")){l.before('<span class="'+this+'_url_path-text path-text"></span>').after('<button type="button" id="mt-set-'+this+'_url_path" class="button mt-edit-field-button">'+i.edit+"</button>").hide();d("span."+this+"_url_path-text").text(l.val());k.parents(".field-content").find(".subdomain").hide();k.parents(".field-content").find(".use-subdomain").hide()}else{k.parents(".field-content").find(".subdomain").show();k.parents(".field-content").find(".use-subdomain").show()}if(m&&m.match(/^http/)){k.parents(".field-content").find(".use-subdomain").hide().end().find("span.archive-url-domain").hide().before('<span class="'+this+'_url_path-text path-text">'+k.val()+"</span>");if(d("button#mt-set-"+this+"_url_path").length==0){l.after('<button type="button" id="mt-set-'+this+'_url_path" class="button mt-edit-field-button">'+i.edit+"</button>").hide()}}d("button#mt-set-"+this+"_url_path").click(function(){d(this).hide();d("span."+n+"_url_subdomain-text").hide();var o=k.val();if(o){k.parents(".field-content").find(".subdomain").show().end().find("span.archive-url-domain").show();if(o.match(/^http/)){k.val("")}}d("span."+n+"_url_path-text").hide();l.show();d(this).parents(".field-content").find(".use-subdomain").show();d("p#"+n+"_url-warning").show();return false})})};d.mtUseAbsolute=function(){var g=d(".site-path-field :checkbox");g.each(function(){if(!this.checked){var h=d(this).parents(".field-content");h.find(".relative-site_path").show();h.find(".absolute-site_path").hide();h.find(".relative-site_path-hint").show();h.find(".absolute-site_path-hint").hide()}else{var h=d(this).parents(".field-content");h.find(".relative-site_path").hide();h.find(".absolute-site_path").show();h.find(".relative-site_path-hint").hide();h.find(".absolute-site_path-hint").show()}});g.click(function(){if(this.checked){var h=d(this).attr("checked",true).parents(".field-content");h.find(".relative-site_path").hide();h.find(".absolute-site_path").show();h.find(".relative-site_path-hint").hide();h.find(".absolute-site_path-hint").show();h.find(".absolute-site_path").find(":input").removeClass("ignore-validate");h.find(".relative-site_path").find(":input").addClass("ignore-validate")}else{var h=d(this).removeAttr("checked").parents(".field-content");h.find(".relative-site_path").show();h.find(".absolute-site_path").hide();h.find(".relative-site_path-hint").show();h.find(".absolute-site_path-hint").hide();h.find(".relative-site_path").find(":input").removeClass("ignore-validate");h.find(".absolute-site_path").find(":input").addClass("ignore-validate")}})};d.mtEditSitePath=function(g){var j={edit:"Edit"};var i=d.extend(j,g);var h=["site","archive"];d.each(h,function(){var m=this;var k=d("input#"+m+"_path_absolute");if(!k.hasClass("show-input")){k.before('<span class="'+m+'_path_absolute-text path-text"></span>').after('<button type="button" id="mt-set-'+m+'_path_absolute" class="button mt-edit-field-button">'+i.edit+"</button>").hide();d("span."+m+"_path_absolute-text").text(k.val())}var l=d("input#"+m+"_path");if(!l.hasClass("show-input")){l.before('<span class="'+m+'_path-text path-text"></span>').after('<button type="button" id="mt-set-'+m+'_path" class="button mt-edit-field-button">'+i.edit+"</button>").hide();d("span."+m+"_path-text").text(l.val());l.parents(".field-content").find(".use-absolute").hide()}d("button#mt-set-"+m+"_path_absolute").click(function(){d("span."+m+"_path_absolute-text").hide();k.addClass("show-input").show();d("p#"+m+"_path-warning").show();d(this).hide();l.parents(".field-content").find(".use-absolute").show();if(!l.hasClass("show-input")){d("button#mt-set-"+m+"_path").click()}return false});d("button#mt-set-"+m+"_path").click(function(){d("span."+m+"_path-text").hide();l.addClass("show-input").show();d("p#"+m+"_path-warning").show();d(this).hide();l.parents(".field-content").find(".use-absolute").show();if(!k.hasClass("show-input")){d("button#mt-set-"+m+"_path_absolute").click()}return false})})};d.mtCheckbox=function(){function g(h){var i=h.find("tbody input:checked").length;if(h.find("tbody :checkbox").length===i){h.find("thead :checkbox, tfoot :checkbox").attr("checked",true)}else{h.find("thead :checkbox, tfoot :checkbox").removeAttr("checked")}}d("thead :checkbox, tfoot :checkbox").click(function(){var h=d(this).parents("table").find(":checkbox");if(this.checked){h.attr("checked",true).parents("tr").addClass("selected").next(".slave").addClass("selected")}else{h.removeAttr("checked").parents("tr").removeClass("selected").next(".slave").removeClass("selected")}});d("tbody :checkbox").click(function(){if(this.checked){d(this).parents("tr").addClass("selected").next(".slave").addClass("selected")}else{d(this).parents("tr").removeClass("selected").next(".slave").removeClass("selected")}g(d(this).parents("table"))});d("tbody").each(function(){d(this).find(":checkbox").parents("tr").removeClass("selected").find("input:checked").parents("tr").addClass("selected");g(d(this).parents("table"))})};d.mtQuickFilter=function(){d("form#list-filter button").hide();d("select.filter-keys").change(function(){d("form#list-filter").submit()})};d.fn.mtDialog=function(g){var i={loadingimage:StaticURI+"images/indicator.gif",esckeyclose:true};var h=d.extend(i,g);b();return this.each(function(){d(this).click(function(){c(this.href,h);return false})})};function b(){d(window).resize(function(){f()});var g=d(".mt-dialog");if(!g.length){d("body").append('<div class="mt-dialog"><span>Close</span></div>');d(".mt-dialog").after('<div class="mt-dialog-overlay overlay"></div>');d(".mt-dialog > div > span").click(function(){a()})}}function f(){var h=d(".mt-dialog");var g=d(window).height();if(h.length){h.height(g-60);d("#mt-dialog-iframe").height(g-60)}}function c(g,i){if(i.form){var j=i.param;d("<iframe />").attr({id:"mt-dialog-iframe",name:"mt-dialog-iframe",frameborder:"0",width:"100%"}).load(function(){d(".mt-dialog .loading").remove()}).appendTo(d(".mt-dialog"));f();d("<img />").attr({src:i.loadingimage}).addClass("loading").appendTo(d(".mt-dialog"));var h=d("<form />").attr({id:"mt-dialog-post-form",method:"post",action:g,target:"mt-dialog-iframe"}).append(d("#"+i.form).children().clone()).appendTo(d(".mt-dialog"));d.each(j,function(k,l){h.find("[name="+k+"]").remove();d("<input />").attr({type:"hidden",name:k,value:l}).appendTo(h)});h.submit();h.remove()}else{d("<iframe />").attr({id:"mt-dialog-iframe",frameborder:"0",src:g+"&dialog=1",width:"100%"}).load(function(){d(".mt-dialog .loading").remove()}).appendTo(d(".mt-dialog"));f();d("<img />").attr({src:i.loadingimage}).addClass("loading").appendTo(d(".mt-dialog"))}if(navigator.userAgent.indexOf("Gecko/")==-1){d("body").addClass("has-dialog")}d(".mt-dialog").show();d(".mt-dialog").bind("close",function(l,k){k(l)});d(".mt-dialog-overlay").show();if(i.esckeyclose){d(document).bind("keyup.mt-dialog",function(k){if(k.keyCode==27){a()}})}if(!d.support.style&&!d.support.objectAll){if(d.fn.bgiframe){d(".mt-dialog-overlay").bgiframe()}if(d.fn.exFixed){d(".mt-dialog").exFixed()}}}function a(g,i){d("body").removeClass("has-dialog");d(".mt-dialog-overlay").hide();if(i){d(".mt-dialog").trigger("close",i)}d(document).unbind("keyup.mt-dialog");d(".mt-dialog").unbind("close");d(".mt-dialog").hide();var h=d("#mt-dialog-iframe").attr("id","mt-dialog-iframe-removed");setTimeout(function(){h.remove()},2000);if(g){window.location=g}}d.fn.mtDialog.open=function(h,g){var j={loadingimage:StaticURI+"images/indicator.gif",esckeyclose:true};var i=d.extend(j,g);b();c(h,i)};d.fn.mtDialog.close=function(g,h){a(g,h);d(window).trigger("dialogDisposed")};d.event.special.dialogReady={setup:function(h,g){return false},teardown:function(g){return false}};d.fn.mtDialogReady=function(g){d(window).trigger("dialogReady")};d.fn.mtRebuild=function(g){var i={};var h=d.extend(i,g);d(this).click(function(){window.open(d(this).attr("href"),"rebuild_blog_"+h.blog_id,"width=400,height=400,resizable=yes");return false})};d.fn.mtSetTip=function(g){var i={tip_color:"#aaaaaa"};var h=d.extend(i,g);return this.each(function(){var j=d(this).attr("title");d(this).val(j).css("color",h.tip_color);d(this).focus(function(){if(this.value==j){d(this).val("").css("color","#000")}});d(this).blur(function(){if(d(this).val()==""){d(this).val(j).css("color",h.tip_color)}if(this.value!=j){d(this).css("color","#000")}})})};d.fn.mtPublishItems=function(g){var i={name:null,args:{}};var h=d.extend(i,g);return this.each(function(){d(this).click(function(){doForMarkedInThisWindow(d("#"+h.id)[0],h.singular,h.plural,h.name,h.mode,h.args,h.phrase);return false})})};d.fn.mtSubmitItems=function(g){var i={};var h=d.extend(i,g);return this.each(function(){d(this).click(function(){d("form#"+h.id+" > input[name=__mode]").val("save_entries")})})};d.fn.mtDeleteItems=function(g){var i={args:{}};var h=d.extend(i,g);return this.each(function(){d(this).click(function(){doRemoveItems(d("#"+h.id)[0],h.singular,h.plural,"",h.args);return false})})};d.fn.mtEnableUsers=function(g){var i={args:{}};var h=d.extend(i,g);return this.each(function(){d(this).click(function(){setObjectStatus(d("#"+h.id)[0],h.plural,h.phrase,1,"",h.args);return false})})};d.fn.mtDisableUsers=function(g){var i={args:{}};var h=d.extend(i,g);return this.each(function(){d(this).click(function(){var j=d("#sysadmin")[0];if(j&&j.checked){alert(h.message);j.click();return false}setObjectStatus(d("#"+h.id)[0],h.plural,h.phrase,0,"",h.args);return false})})};d.fn.mtDoPluginAction=function(g){var i={args:{}};var h=d.extend(i,g);return this.each(function(){d(this).click(function(){doPluginAction(d("#"+h.id)[0],h.plural,h.args,h.phrase);return false})})};d.fn.mtSetObjectStatus=function(g){var i={args:{}};var h=d.extend(i,g);return this.each(function(){d(this).click(function(){setObjectStatus(d("#"+h.id)[0],h.singular,h.plural,h.status,"",h.args);return false})})};d.fn.mtRebasename=function(g){var i={text:"..."};var h=d.extend(i,g);return this.each(function(){var k=d("input#basename");var j=k.hide().val();k.hide().before('<span class="basename-text"></span>');k.parent("span.basename").after('<button type="button" id="mt-set-basename" class="mt-edit-field-button button">'+h.edit+"</button>");if(h.basename){d("span.basename-text").text(h.basename)}else{d("span.basename-text").text(j||h.text)}d(this).keyup(function(){if(!h.basename){j=dirify(d(this).val());if(h.limit){j=j.substring(0,h.limit)}d("span.basename-text").text(j||h.text);k.val(j)}});d("button#mt-set-basename").click(function(){d(this).hide();d("span.basename-text").hide();d("input#basename").show();return false})})};d.fn.mtEditInput=function(g){var i={save:"Save"};var h=d.extend(i,g);return this.each(function(){var k=d(this).attr("id");var j=d("input#"+k);if(j.val()&&!j.hasClass("show-input")){j.before('<span class="'+k+'-text"></span>').after('<button type="button" id="mt-set-'+k+'" class="mt-edit-field-button button">'+h.edit+"</button>").hide();d("span."+k+"-text").text(j.val())}if(!j.val()&&j.hasClass("hide-input")){j.before('<span class="'+k+'-text"></span>').after('<button type="button" id="mt-set-'+k+'" class="mt-edit-field-button button">'+h.edit+"</button>").hide()}d("button#mt-set-"+k).click(function(){d(this).hide();d("span."+k+"-text").hide();d("input#"+k).show();d("p#"+k+"-warning").show();return false})})};d.fn.mtCheckboxOption=function(){return this.each(function(){var g=d(this).find(":checkbox");var h=g.attr("id");if(!g.attr("checked")){d("div#"+h+"-option").hide()}g.click(function(){d("div#"+h+"-option").toggle()})})};d.fn.mtToggleField=function(g){var i={click_class:"detail-link",detail_class:"detail",hide_clicked:false,default_hide:true};var h=d.extend(i,g);return this.each(function(){var j=d(this);if(h.default_hide){j.find("."+h.detail_class).hide()}j.find("."+h.click_class).mousedown(function(k){j.toggleClass("active").find("."+h.detail_class).toggle();return false}).click(function(k){return false});if(h.hide_clicked){d(document).mousedown(function(k){if(d(k.target).parents(".active").length==0){j.removeClass("active").find("."+h.detail_class).hide()}})}})};var e={};d.mtValidator=function(h,g){if(this instanceof d.mtValidator){var i=e[h]||this;if(!g){return i}d.extend(i,g);i.namespace=h;return e[h]=i}else{if(typeof h=="object"){g=h;h="default"}if(!h){h="default"}if(!g&&e[h]){return e[h]}return new d.mtValidator(h,g)}};d.extend(d.mtValidator.prototype,{options:{},validateElement:function(g,h){var i=this;if(undefined===h){h={}}var j=d.extend({},d.mtValidateRules,h);i.error=false;i.errstr=undefined;d.each(j,function(k,m){if(g.is(k)){i.error=false;i.errstr=undefined;var l=m.apply(i,[g]);if(i.error||!l){if(!i.errstr){i.raise(d.mtValidateMessages["#"+g.attr("id")+k]||d.mtValidateMessages[k]||"Invalid value")}return false}}});return !i.error},raise:function(g){this.error=true;this.errstr=g||trans("Invalid value");return false},validClass:"valid",errorClass:"error",doFocus:true,wrapError:function(g,h){return d("<label/>").attr("for",g.attr("id")).addClass("validate-error msg-error").text(h)},updateError:function(g,h,i){h.text(i)},showError:function(g,h){g.after(h)},removeError:function(g,h){h.remove()}});d.mtValidator("top",{wrapError:function(g,h){return d("<li />").append(d("<label/>").attr("for",g.attr("id")).text(h))},showError:function(g,h){if(d("div#msg-block").text()==0){var i=d("<div/>").addClass("msg msg-error").append(d("<p>").text(trans("You have an error in your input."))).append(d("<ul />"));d("div#msg-block").append(i)}d("div#msg-block ul").append(h)},removeError:function(g,h){h.remove();if(d("div#msg-block ul li").length==0){d("div#msg-block").text("")}},updateError:function(g,h,i){h.find("label").text(i)}});d.mtValidator("simple",{wrapError:function(g,h){return d("<div />").append(d("<label/>").attr("for",g.attr("id")).addClass("validate-error msg-error").text(h))},updateError:function(g,h,i){h.find("label.msg-error").text(i)}});d.mtValidator("simple2",{wrapError:function(g,h){return d("<li />").append(d("<label/>").attr("for",g.attr("id")).text(h))},showError:function(g,h){var k=g.parents().find("div.field-content").first().parent().attr("id");var i=true;if(d("div#"+k+"-msg-block ul").length==0){var j=d("<div/>").addClass("validate-error msg-error").append(d("<ul />"));d("div#"+k+"-msg-block").append(j)}else{d("div#"+k+"-msg-block ul li").each(function(){var l=d(this);var m=h.text();if(l.text()===m){i=false}})}if(i){d("div#"+k+"-msg-block ul").append(h);d("div#"+k+"-msg-block").show()}},removeError:function(g,h){var i=g.parents().find("div.field-content").first().parent().attr("id");h.remove();if(d("div#"+i+"-msg-block ul li").length==0){d("div#"+i+"-msg-block").hide()}},updateError:function(g,h,j){var k=g.parents().find("div.field-content").first().parent().attr("id");var i=true;d("div#"+k+"-msg-block ul li").each(function(){var l=d(this);if(l.text()===j){i=false}});if(i){h.find("label").text(j);this.showError(g,h)}}});d.mtValidator("default",{wrapError:function(g,h){return d('<label style="position: absolute;" />').attr("for",g.attr("id")||"").addClass("msg-error msg-balloon validate-error").text(h)},showError:function(g,i){var h=function(){i.show()};var k=function(){i.hide()};jQuery.data(g.get(0),"validate_focus",h);jQuery.data(g.get(0),"validate_blur",k);g.bind("focus",h).bind("blur",k);if(g.get(0)===document.activeElement){i.show()}else{i.hide()}try{if(!g.parent(".validate-error-wrapper").length){g.wrap('<span class="validate-error-wrapper" style="position: relative; white-space: nowrap;"></span>')}}catch(j){}g.after(i);i.css("left",g.width()).css("top",-1*g.height()).css("z-index",200)},removeError:function(g,i){i.remove();var h=jQuery.data(g.get(0),"validate_focus");var j=jQuery.data(g.get(0),"validate_blur");g.unbind("focus",h).unbind("blur",j)},doFocus:false});d.mtValidator("dialog",{wrapError:function(g,h){return d("<label/>").attr("for",g.attr("id")).addClass("msg msg-error dialog-msg-error").text(h)},showError:function(g,h){g.parents("div.ui-dialog").find("div.dialog-msg-block").append(h)}});d.mtValidateRules={".date":function(g){return !g.val()||/^\d{4}\-\d{2}\-\d{2}$/.test(g.val())},".email":function(g){return !g.val()||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(g.val())},".url":function(g){return !g.val()||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(g.val())},".required":function(g){return g.val().length>0},".digit, .num":function(g){return !g.val()||/^\d+$/.test(g.val())},".number":function(g){return !g.val()||/\d/.test(g.val())&&/^\d*\.?\d*$/.test(g.val())}};d.mtValidateAddRules=function(g){d.mtValidateRules=d.extend(d.mtValidateRules,g)};d.mtValidateAddMessages=function(g){d.mtValidateMessages=d.extend(d.mtValidateMessages,g)};d.mtValidateMessages={".date":trans("Invalid date format"),".email":trans("Invalid email address"),".url":trans("Invalid URL"),".required":trans("This field is required"),".digit, .num":trans("This field must be an integer"),".number":trans("This field must be a number")};d.fn.extend({mtValidate:function(g,h){if(undefined===h){h={}}this.each(function(){d.data(this,"mtValidator",g||"default");d.data(this,"mtValidateRules",h)});return this.mtValid()},mtValidator:function(){var g=d.data(this.get(0),"mtValidator");return d.mtValidator(g)},mtValid:function(i){var k=0;var g=[];var h=0;var j={focus:true};i=d.extend(j,i);this.each(function(){var p=d(this);var o=p.mtValidator();if(!o){return true}if(typeof p.attr("data-showing-placeholder")!=="undefined"){p.val("")}var r=d.data(this,"mtValidateRules");var n=o.validateElement(p,r);if(n){var m=d.data(this,"mtValidateError");h++;if(m){o.removeError(p,m)}d.data(this,"mtValidateError",null);d.data(this,"mtValidateLastError",null);p.addClass(o.validClass);p.removeClass(o.errorClass)}else{var m=d.data(this,"mtValidateError");k++;if(o.doFocus){g.push(p)}var q=o.errstr;if(m){o.updateError(p,m,q)}else{var l=o.wrapError(p,q);o.showError(p,l);d.data(this,"mtValidateError",l);d.data(this,"mtValidateLastError",q)}d.data(this,"mtValidateLastError",q);p.addClass(o.errorClass);p.removeClass(o.validClass)}});if(i.focus&&g.length){g[0].focus()}return k==0},mtUnvalidate:function(){this.each(function(){var h=d(this).mtValidator();if(h){var g=d.data(this,"mtValidateError");if(g){h.removeError(d(this),g)}d.data(this,"mtValidator",null);d.data(this,"mtValidateError",null);d.data(this,"mtValidateLastError",null);d(this).removeClass(h.errorClass);d(this).removeClass(h.validClass)}});return this}});d("input, textarea").live("keyup focusin focusout",function(){var g=d.data(this,"mtValidator");if(!g){return true}d(this).mtValid({focus:false})});d("select").live("change",function(){var g=d.data(this,"mtValidator");if(!g){return true}d(this).mtValid({focus:false})});d.fn.mtPlaceholder=function(){if("placeholder" in d("<input />").get(0)){return this}this.each(function(){var h=this;var g=d(h);var i=g.attr("placeholder");if(1>g.val().length){g.val(i).css("color","GrayText").attr("data-showing-placeholder","showing")}g.focus(function(){if(g.attr("data-showing-placeholder")){g.val("").css("color","#2b2b2b").removeAttr("data-showing-placeholder")}}).blur(function(){if(1>g.val().length){g.val(i).css("color","GrayText").attr("data-showing-placeholder","showing")}}).parents("form").submit(function(){if(g.attr("data-showing-placeholder")){g.removeAttr("data-showing-placeholder");g.val("")}})});return this}})(jQuery);