window.addEventListener("unhandledrejection",async e=>{e.reason instanceof a&&(e.preventDefault(),(await window.MT.import("Alert")).danger(e.reason),(await window.MT.import("Logger")).error(`UNHANDLED PROMISE REJECTION: ${e.reason}`))});class a extends Error{}function s(e,r){var n,o;if(e instanceof URLSearchParams){const t=`${window.CMSScriptURI}?${e.toString()}`;return new Request(t,r)}else if(e instanceof FormData){const t=(n=document.querySelector('input[name="magic_token"]'))===null||n===void 0?void 0:n.value;if(!t)throw new Error("Failed to get magick token.");return e.append("magick_token",t),new Request(window.CMSScriptURI,Object.assign({},r,{method:(o=r.method)!==null&&o!==void 0?o:"POST",body:e}))}else return new Request(e,r)}function i(e,r){const n=Object.assign({},r||{});n.headers=Object.assign({},n.headers||{}),n.headers["X-Requested-With"]="XMLHttpRequest";const o=e instanceof Request?e:s(e,n);return fetch(o).then(async t=>{if(t.status!==200)throw new a(await t.text());return t}).catch(t=>{throw new a(t.toString())})}export{i as sendHttpRequest};
