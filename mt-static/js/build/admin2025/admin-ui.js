function Z(){}function kt(t){return t()}function vt(){return Object.create(null)}function me(t){t.forEach(kt)}function tt(t){return typeof t=="function"}function Me(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Yt(t){return Object.keys(t).length===0}function ve(t){return t&&tt(t.destroy)?t.destroy:Z}const Zt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function c(t,e){t.appendChild(e)}function C(t,e,n){t.insertBefore(e,n||null)}function L(t){t.parentNode&&t.parentNode.removeChild(t)}function nt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function lt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function K(t){return document.createTextNode(t)}function T(){return K(" ")}function Fe(){return K("")}function F(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function r(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function St(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function xt(t){let e;return{p(...n){e=n,e.forEach(l=>t.push(l))},r(){e.forEach(n=>t.splice(t.indexOf(n),1))}}}function $t(t){return Array.from(t.childNodes)}function Se(t,e){e=""+e,t.data!==e&&(t.data=e)}function he(t,e){t.value=e??""}function Tt(t,e,n){for(let l=0;l<t.options.length;l+=1){const s=t.options[l];if(s.__value===e){s.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function en(t){const e=t.querySelector(":checked");return e&&e.__value}function Rt(t,e,n){t.classList.toggle(e,!!n)}let Je;function We(t){Je=t}function tn(){if(!Je)throw new Error("Function called outside component initialization");return Je}function Lt(t){tn().$$.on_mount.push(t)}const je=[],Le=[];let Ue=[];const Nt=[],Ct=Promise.resolve();let it=!1;function It(){it||(it=!0,Ct.then(Mt))}function Et(){return It(),Ct}function Ge(t){Ue.push(t)}const st=new Set;let qe=0;function Mt(){if(qe!==0)return;const t=Je;do{try{for(;qe<je.length;){const e=je[qe];qe++,We(e),nn(e.$$)}}catch(e){throw je.length=0,qe=0,e}for(We(null),je.length=0,qe=0;Le.length;)Le.pop()();for(let e=0;e<Ue.length;e+=1){const n=Ue[e];st.has(n)||(st.add(n),n())}Ue.length=0}while(je.length);for(;Nt.length;)Nt.pop()();it=!1,st.clear(),We(t)}function nn(t){if(t.fragment!==null){t.update(),me(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ge)}}function ln(t){const e=[],n=[];Ue.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),Ue=e}const Ke=new Set;let Ne;function Ye(){Ne={r:0,c:[],p:Ne}}function Ze(){Ne.r||me(Ne.c),Ne=Ne.p}function te(t,e){t&&t.i&&(Ke.delete(t),t.i(e))}function ie(t,e,n,l){if(t&&t.o){if(Ke.has(t))return;Ke.add(t),Ne.c.push(()=>{Ke.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function Te(t){return t?.length!==void 0?t:Array.from(t)}function sn(t,e){ie(t,1,1,()=>{e.delete(t.key)})}function on(t,e,n,l,s,o,i,a,d,_,y,w){let p=t.length,m=o.length,h=p;const v={};for(;h--;)v[t[h].key]=h;const b=[],I=new Map,J=new Map,M=[];for(h=m;h--;){const E=w(s,o,h),P=n(E);let S=i.get(P);S?M.push(()=>S.p(E,e)):(S=_(P,E),S.c()),I.set(P,b[h]=S),P in v&&J.set(P,Math.abs(h-v[P]))}const N=new Set,q=new Set;function O(E){te(E,1),E.m(a,y),i.set(E.key,E),y=E.first,m--}for(;p&&m;){const E=b[m-1],P=t[p-1],S=E.key,j=P.key;E===P?(y=E.first,p--,m--):I.has(j)?!i.has(S)||N.has(S)?O(E):q.has(j)?p--:J.get(S)>J.get(j)?(q.add(S),O(E)):(N.add(j),p--):(d(P,i),p--)}for(;p--;){const E=t[p];I.has(E.key)||d(E,i)}for(;m;)O(b[m-1]);return me(M),b}function Pe(t){t&&t.c()}function Ce(t,e,n){const{fragment:l,after_update:s}=t.$$;l&&l.m(e,n),Ge(()=>{const o=t.$$.on_mount.map(kt).filter(tt);t.$$.on_destroy?t.$$.on_destroy.push(...o):me(o),t.$$.on_mount=[]}),s.forEach(Ge)}function Ie(t,e){const n=t.$$;n.fragment!==null&&(ln(n.after_update),me(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function an(t,e){t.$$.dirty[0]===-1&&(je.push(t),It(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ae(t,e,n,l,s,o,i=null,a=[-1]){const d=Je;We(t);const _=t.$$={fragment:null,ctx:[],props:o,update:Z,not_equal:s,bound:vt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:vt(),dirty:a,skip_bound:!1,root:e.target||d.$$.root};i&&i(_.root);let y=!1;if(_.ctx=n?n(t,e.props||{},(w,p,...m)=>{const h=m.length?m[0]:p;return _.ctx&&s(_.ctx[w],_.ctx[w]=h)&&(!_.skip_bound&&_.bound[w]&&_.bound[w](h),y&&an(t,w)),p}):[],_.update(),y=!0,me(_.before_update),_.fragment=l?l(_.ctx):!1,e.target){if(e.hydrate){const w=$t(e.target);_.fragment&&_.fragment.l(w),w.forEach(L)}else _.fragment&&_.fragment.c();e.intro&&te(t.$$.fragment),Ce(t,e.target,e.anchor),Mt()}We(d)}class Oe{$$=void 0;$$set=void 0;$destroy(){Ie(this,1),this.$destroy=Z}$on(e,n){if(!tt(n))return Z;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const s=l.indexOf(n);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!Yt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const rn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(rn);function He(t,e="body"){let n;async function l(o){if(e=o,typeof e=="string"){if(n=document.querySelector(e),n===null&&(await Et(),n=document.querySelector(e)),n===null)throw new Error(`No element found matching css selector: "${e}"`)}else if(e instanceof HTMLElement)n=e;else throw new TypeError(`Unknown portal target type: ${e===null?"null":typeof e}. Allowed types: string (CSS selector) or HTMLElement.`);n.appendChild(t),t.hidden=!1}function s(){t.parentNode&&t.parentNode.removeChild(t)}return l(e),{update:l,destroy:s}}function ot(t,e){return!t.some(n=>n&&n.contains(e))}const at=async t=>{const e={__mode:"content_types_for_search_action",blog_id:t.blogId,magic_token:t.magicToken};let n,l;try{l=await jQuery.ajax(window.ScriptURI,{type:"POST",contentType:"application/x-www-form-urlencoded; charset=utf-8",data:e,dataType:"json",error:s=>{(s.readyState===0||s.status===0)&&(n="possibly unloaded")}})}catch(s){n??(n=s)}return n||l.result.success!==1?{contentTypes:[]}:{contentTypes:l.result.content_types}};function jt(t,e,n){const l=t.slice();return l[12]=e[n],l}function Ut(t){let e,n,l,s,o,i,a,d,_,y,w,p=window.trans("New [_1] creation",window.trans("Entry"))+"",m,h,v,b,I,J=window.trans("New [_1] creation",window.trans("Page"))+"",M,N,q,O;function E(j,U){if(j[3])return dn;if(j[4].length>0)return cn}let P=E(t),S=P&&P(t);return{c(){e=u("div"),n=u("div"),l=u("button"),l.innerHTML='<span aria-hidden="true">\xD7</span>',s=T(),o=u("div"),S&&S.c(),i=T(),a=u("p"),a.textContent=`${`${window.trans("Entry")}\u30FB${window.trans("Page")}`}`,d=T(),_=u("ul"),y=u("li"),w=u("a"),m=K(p),v=T(),b=u("li"),I=u("a"),M=K(J),r(l,"type","button"),r(l,"class","close"),r(l,"data-dismiss","modal"),r(l,"aria-label","Close"),r(n,"class","modal-header"),r(a,"class","block-title"),r(w,"href",h=`${window.CMSScriptURI}?__mode=view&_type=entry&blog_id=${t[1]}`),r(I,"href",N=`${window.CMSScriptURI}?__mode=view&_type=page&blog_id=${t[1]}`),r(_,"class","create-button-list"),r(o,"class","modal-body"),r(e,"class","modal create-button-modal")},m(j,U){C(j,e,U),c(e,n),c(n,l),c(e,s),c(e,o),S&&S.m(o,null),c(o,i),c(o,a),c(o,d),c(o,_),c(_,y),c(y,w),c(w,m),c(_,v),c(_,b),c(b,I),c(I,M),t[11](e),q||(O=[F(l,"click",t[5]),ve(He.call(null,e,"body"))],q=!0)},p(j,U){P===(P=E(j))&&S?S.p(j,U):(S&&S.d(1),S=P&&P(j),S&&(S.c(),S.m(o,i))),U&2&&h!==(h=`${window.CMSScriptURI}?__mode=view&_type=entry&blog_id=${j[1]}`)&&r(w,"href",h),U&2&&N!==(N=`${window.CMSScriptURI}?__mode=view&_type=page&blog_id=${j[1]}`)&&r(I,"href",N)},d(j){j&&L(e),S&&S.d(),t[11](null),q=!1,me(O)}}}function cn(t){let e,n,l,s=Te(t[4]),o=[];for(let i=0;i<s.length;i+=1)o[i]=qt(jt(t,s,i));return{c(){e=u("p"),e.textContent=`${window.trans("Content Data")}`,n=T(),l=u("ul");for(let i=0;i<o.length;i+=1)o[i].c();r(e,"class","block-title"),r(l,"class","create-button-list")},m(i,a){C(i,e,a),C(i,n,a),C(i,l,a);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(l,null)},p(i,a){if(a&18){s=Te(i[4]);let d;for(d=0;d<s.length;d+=1){const _=jt(i,s,d);o[d]?o[d].p(_,a):(o[d]=qt(_),o[d].c(),o[d].m(l,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(i){i&&(L(e),L(n),L(l)),nt(o,i)}}}function dn(t){let e;return{c(){e=u("p"),e.textContent=`${window.trans("Loading...")}`},m(n,l){C(n,e,l)},p:Z,d(n){n&&L(e)}}}function qt(t){let e,n,l=window.trans("New [_1] creation",t[12].name)+"",s,o,i;return{c(){e=u("li"),n=u("a"),s=K(l),i=T(),r(n,"href",o=`${window.CMSScriptURI}?__mode=view&_type=content_data&content_type_id=${t[12].id}&type=content_data_${t[12].id}&blog_id=${t[1]}`)},m(a,d){C(a,e,d),c(e,n),c(n,s),c(e,i)},p(a,d){d&16&&l!==(l=window.trans("New [_1] creation",a[12].name)+"")&&Se(s,l),d&18&&o!==(o=`${window.CMSScriptURI}?__mode=view&_type=content_data&content_type_id=${a[12].id}&type=content_data_${a[12].id}&blog_id=${a[1]}`)&&r(n,"href",o)},d(a){a&&L(e)}}}function un(t){let e,n,l,s,o=t[0]&&Ut(t);return{c(){e=T(),o&&o.c(),n=Fe()},m(i,a){C(i,e,a),o&&o.m(i,a),C(i,n,a),l||(s=F(document.body,"click",t[6]),l=!0)},p(i,[a]){i[0]?o?o.p(i,a):(o=Ut(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:Z,o:Z,d(i){i&&(L(e),L(n)),o&&o.d(i),l=!1,s()}}}function fn(t,e,n){let{blog_id:l}=e,{magicToken:s}=e,{open:o=!1}=e,{anchorRef:i=null}=e,{containerRef:a=null}=e,d=null,_=!1,y=!1,w=[];const p=()=>{n(0,o=!1)},m=v=>{if(a&&a.classList.contains("show"))return;const b=v.target;o&&ot([i,d],b)&&p()};function h(v){Le[v?"unshift":"push"](()=>{d=v,n(2,d),n(8,i),n(0,o),n(10,_),n(3,y),n(1,l),n(7,s)})}return t.$$set=v=>{"blog_id"in v&&n(1,l=v.blog_id),"magicToken"in v&&n(7,s=v.magicToken),"open"in v&&n(0,o=v.open),"anchorRef"in v&&n(8,i=v.anchorRef),"containerRef"in v&&n(9,a=v.containerRef)},t.$$.update=()=>{if(t.$$.dirty&1423&&i){if(d){const v=i.getBoundingClientRect(),b=`calc(${v.bottom}px + 10px)`;n(2,d.style.top=b,d);const I=`calc(100vh - ${v.bottom}px - 10px - 20px)`;n(2,d.style.maxHeight=I,d)}o?(i.classList.add("open"),!_&&!y&&(n(3,y=!0),at({blogId:l,magicToken:s}).then(v=>{n(4,w=v.contentTypes.filter(b=>b.can_create===1)),n(10,_=!0),n(3,y=!1)}).catch(v=>{console.error("Failed to fetch content types:",v),n(3,y=!1)}))):i.classList.remove("open")}},[o,l,d,y,w,p,m,s,i,a,_,h]}class _n extends Oe{constructor(e){super(),Ae(this,e,fn,un,Me,{blog_id:1,magicToken:7,open:0,anchorRef:8,containerRef:9})}}const pn=({target:t,props:e})=>{const n=new _n({target:t,props:e});t.addEventListener("click",l=>{l.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,n.$set(e)})};function mn(t){let e,n,l,s;return{c(){e=u("div"),r(e,"class","mt-primaryNavigation-overlay"),r(e,"style",n=`display: ${t[0]?"block":"none"}`)},m(o,i){C(o,e,i),l||(s=[ve(He.call(null,e,"body")),F(e,"mouseenter",t[1])],l=!0)},p(o,[i]){i&1&&n!==(n=`display: ${o[0]?"block":"none"}`)&&r(e,"style",n)},i:Z,o:Z,d(o){o&&L(e),l=!1,me(s)}}}function hn(t,e,n){let{buttonRef:l}=e,{collapsed:s=!1}=e,{isStored:o=!1}=e,i=!1;const a=(p,m)=>{const h=document.querySelector('[data-is="content-wrapper"]');m?h.classList.add(p):h.classList.remove(p)},d=()=>{a("collapsed",s)},_=()=>{a("mouseover",i)},y=()=>{var p;s&&(i=!0,_(),(p=document.querySelector('[data-is="primary-navigation"]'))===null||p===void 0||p.addEventListener("mouseleave",w,{once:!0}))},w=()=>{i=!1,_()};return Lt(()=>{o||window.innerWidth<1e3&&n(0,s=!0),window.innerWidth<800&&n(0,s=!0),d()}),t.$$set=p=>{"buttonRef"in p&&n(2,l=p.buttonRef),"collapsed"in p&&n(0,s=p.collapsed),"isStored"in p&&n(3,o=p.isStored)},t.$$.update=()=>{t.$$.dirty&5&&(d(),i=!1,_(),l&&(s?(l.classList.remove("expanded"),l.classList.add("collapsed"),document.body.dataset.isCollapsed="true"):(l.classList.remove("collapsed"),l.classList.add("expanded"),document.body.dataset.isCollapsed="false")))},[s,y,l,o]}class bn extends Oe{constructor(e){super(),Ae(this,e,hn,mn,Me,{buttonRef:2,collapsed:0,isStored:3})}}function gn(t,e){const n=new bn({target:t,props:{collapsed:e.collapsed,buttonRef:e.buttonRef,isStored:e.isStored}});e.buttonRef.addEventListener("click",()=>{e.buttonRef.classList.contains("collapsed")?e.collapsed=!1:e.collapsed=!0,n.$set(e),sessionStorage.setItem(e.sessionName,e.collapsed.toString())})}const Pt=t=>{const e=window.innerWidth-document.documentElement.clientWidth;e>0&&document.documentElement.style.setProperty("--scrollbar-width",`${e}px`),t.classList.add("mt-modal-overlay")};function At(t){let e,n;return{c(){e=lt("title"),n=K(t[2])},m(l,s){C(l,e,s),c(e,n)},p(l,s){s&4&&Se(n,l[2])},d(l){l&&L(e)}}}function yn(t){let e,n,l=t[2]&&At(t);return{c(){e=lt("svg"),l&&l.c(),n=lt("use"),St(n,"xlink:href",t[1]),r(e,"role","img"),r(e,"class",t[0]),r(e,"style",t[3])},m(s,o){C(s,e,o),l&&l.m(e,null),c(e,n)},p(s,[o]){s[2]?l?l.p(s,o):(l=At(s),l.c(),l.m(e,n)):l&&(l.d(1),l=null),o&2&&St(n,"xlink:href",s[1]),o&1&&r(e,"class",s[0]),o&8&&r(e,"style",s[3])},i:Z,o:Z,d(s){s&&L(e),l&&l.d()}}}function wn(t,e,n){let{class:l}=e,{href:s}=e,{title:o}=e,{style:i=void 0}=e;return t.$$set=a=>{"class"in a&&n(0,l=a.class),"href"in a&&n(1,s=a.href),"title"in a&&n(2,o=a.title),"style"in a&&n(3,i=a.style)},[l,s,o,i]}class De extends Oe{constructor(e){super(),Ae(this,e,wn,yn,Me,{class:0,href:1,title:2,style:3})}}function Ot(t,e,n){const l=t.slice();return l[10]=e[n],l}function Ht(t,e,n){const l=t.slice();return l[13]=e[n],l}function Bt(t){let e,n,l,s=!1,o,i,a,d=t[13].label+"",_,y,w,p,m;return w=xt(t[8][0]),{c(){e=u("label"),n=u("input"),a=T(),_=K(d),y=T(),r(n,"type","radio"),r(n,"name","type"),n.__value=l=t[13].key,he(n,n.__value),r(n,"id",o=t[13].key),n.checked=i=t[0]===t[13].key,w.p(n)},m(h,v){C(h,e,v),c(e,n),n.checked=n.__value===t[0],c(e,a),c(e,_),c(e,y),p||(m=F(n,"change",t[7]),p=!0)},p(h,v){v&16&&l!==(l=h[13].key)&&(n.__value=l,he(n,n.__value),s=!0),v&16&&o!==(o=h[13].key)&&r(n,"id",o),v&17&&i!==(i=h[0]===h[13].key)&&(n.checked=i),(s||v&17)&&(n.checked=n.__value===h[0]),v&16&&d!==(d=h[13].label+"")&&Se(_,d)},d(h){h&&L(e),w.r(),p=!1,m()}}}function kn(t){let e,n;function l(i,a){return i[3].length>0?Tn:Sn}let s=l(t),o=s(t);return{c(){e=u("select"),o.c(),r(e,"class","custom-select form-control form-select"),r(e,"name","content_type_id"),e.disabled=n=t[0]!=="content_data"||t[3].length===0,Rt(e,"disabled",t[0]!=="content_data")},m(i,a){C(i,e,a),o.m(e,null)},p(i,a){s===(s=l(i))&&o?o.p(i,a):(o.d(1),o=s(i),o&&(o.c(),o.m(e,null))),a&9&&n!==(n=i[0]!=="content_data"||i[3].length===0)&&(e.disabled=n),a&1&&Rt(e,"disabled",i[0]!=="content_data")},d(i){i&&L(e),o.d()}}}function vn(t){let e;return{c(){e=u("p"),e.textContent=`${window.trans("Loading...")}`},m(n,l){C(n,e,l)},p:Z,d(n){n&&L(e)}}}function Sn(t){let e;return{c(){e=u("option"),e.textContent=`${window.trans("No Content Type could be found.")}`,e.__value="",he(e,e.__value)},m(n,l){C(n,e,l)},p:Z,d(n){n&&L(e)}}}function Tn(t){let e,n=Te(t[3]),l=[];for(let s=0;s<n.length;s+=1)l[s]=Ft(Ot(t,n,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Fe()},m(s,o){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(s,o);C(s,e,o)},p(s,o){if(o&8){n=Te(s[3]);let i;for(i=0;i<n.length;i+=1){const a=Ot(s,n,i);l[i]?l[i].p(a,o):(l[i]=Ft(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(s){s&&L(e),nt(l,s)}}}function Ft(t){let e,n=t[10].name+"",l,s;return{c(){e=u("option"),l=K(n),e.__value=s=t[10].id,he(e,e.__value)},m(o,i){C(o,e,i),c(e,l)},p(o,i){i&8&&n!==(n=o[10].name+"")&&Se(l,n),i&8&&s!==(s=o[10].id)&&(e.__value=s,he(e,e.__value))},d(o){o&&L(e)}}}function Rn(t){let e,n,l,s,o,i,a,d,_,y,w,p,m,h,v,b,I,J,M,N,q,O,E,P,S,j=Te(t[4]),U=[];for(let R=0;R<j.length;R+=1)U[R]=Bt(Ht(t,j,R));function ne(R,V){return R[5]?vn:kn}let z=ne(t),W=z(t);return O=new De({props:{title:window.trans("Search"),class:"mt-icon mt-icon--sm",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_search`}}),{c(){e=u("form"),n=u("input"),l=T(),s=u("input"),o=T(),i=u("input"),a=T(),d=u("input"),_=T(),y=u("input"),w=T(),p=u("div");for(let R=0;R<U.length;R+=1)U[R].c();m=T(),h=u("div"),W.c(),v=T(),b=u("div"),I=u("div"),J=u("input"),M=T(),N=u("div"),q=u("button"),Pe(O.$$.fragment),E=T(),P=u("span"),P.textContent=`${window.trans("Search")}`,r(n,"type","hidden"),r(n,"name","__mode"),n.value="search_replace",r(s,"type","hidden"),r(s,"name","blog_id"),s.value=t[1],r(i,"type","hidden"),r(i,"name","_type"),i.value=t[0],r(d,"type","hidden"),r(d,"name","do_search"),d.value="1",r(y,"type","hidden"),r(y,"name","magic_token"),y.value=t[2],r(p,"class","search-type"),r(h,"class","search-content-type"),r(J,"type","text"),r(J,"placeholder",window.trans("Select target and search text...")),r(J,"name","search"),r(I,"class","search-text-box"),r(q,"type","submit"),r(q,"class","btn btn-primary"),r(N,"class","submit-button"),r(b,"class","search-input-group"),r(e,"class","mt-search-form"),r(e,"method","post"),r(e,"action",window.ScriptURI)},m(R,V){C(R,e,V),c(e,n),c(e,l),c(e,s),c(e,o),c(e,i),c(e,a),c(e,d),c(e,_),c(e,y),c(e,w),c(e,p);for(let A=0;A<U.length;A+=1)U[A]&&U[A].m(p,null);c(e,m),c(e,h),W.m(h,null),c(e,v),c(e,b),c(b,I),c(I,J),t[9](J),c(b,M),c(b,N),c(N,q),Ce(O,q,null),c(q,E),c(q,P),S=!0},p(R,[V]){if((!S||V&2)&&(s.value=R[1]),(!S||V&1)&&(i.value=R[0]),(!S||V&4)&&(y.value=R[2]),V&17){j=Te(R[4]);let A;for(A=0;A<j.length;A+=1){const D=Ht(R,j,A);U[A]?U[A].p(D,V):(U[A]=Bt(D),U[A].c(),U[A].m(p,null))}for(;A<U.length;A+=1)U[A].d(1);U.length=j.length}z===(z=ne(R))&&W?W.p(R,V):(W.d(1),W=z(R),W&&(W.c(),W.m(h,null)))},i(R){S||(te(O.$$.fragment,R),S=!0)},o(R){ie(O.$$.fragment,R),S=!1},d(R){R&&L(e),nt(U,R),W.d(),t[9](null),Ie(O)}}}function Ln(t,e,n){let{blogId:l}=e,{magicToken:s}=e,{contentTypes:o=[]}=e,{searchTabs:i=[]}=e,{objectType:a}=e,{isLoading:d=!1}=e,_=null;const y=[[]];function w(){a=this.__value,n(0,a)}function p(m){Le[m?"unshift":"push"](()=>{_=m,n(6,_)})}return t.$$set=m=>{"blogId"in m&&n(1,l=m.blogId),"magicToken"in m&&n(2,s=m.magicToken),"contentTypes"in m&&n(3,o=m.contentTypes),"searchTabs"in m&&n(4,i=m.searchTabs),"objectType"in m&&n(0,a=m.objectType),"isLoading"in m&&n(5,d=m.isLoading)},t.$$.update=()=>{t.$$.dirty&64&&_&&_.focus()},[a,l,s,o,i,d,_,w,y,p]}class Jt extends Oe{constructor(e){super(),Ae(this,e,Ln,Rn,Me,{blogId:1,magicToken:2,contentTypes:3,searchTabs:4,objectType:0,isLoading:5})}}function Wt(t){let e,n,l,s,o,i,a,d,_,y,w;return d=new Jt({props:{blogId:t[2],magicToken:t[3],contentTypes:t[6],objectType:t[1],searchTabs:t[4],isLoading:t[5]}}),{c(){e=u("div"),n=T(),l=u("div"),s=u("div"),o=u("button"),o.innerHTML='<span aria-hidden="true">\xD7</span>',i=T(),a=u("div"),Pe(d.$$.fragment),r(e,"class","search-button-modal-overlay"),r(o,"type","button"),r(o,"class","close"),r(o,"data-dismiss","modal"),r(o,"aria-label","Close"),r(s,"class","modal-header"),r(a,"class","modal-body"),r(l,"class","modal search-button-modal")},m(p,m){C(p,e,m),C(p,n,m),C(p,l,m),c(l,s),c(s,o),c(l,i),c(l,a),Ce(d,a,null),t[12](l),_=!0,y||(w=[F(e,"click",t[8]),ve(He.call(null,e,"body")),ve(Pt.call(null,e)),F(o,"click",t[8]),ve(He.call(null,l,"body"))],y=!0)},p(p,m){const h={};m&4&&(h.blogId=p[2]),m&8&&(h.magicToken=p[3]),m&64&&(h.contentTypes=p[6]),m&2&&(h.objectType=p[1]),m&16&&(h.searchTabs=p[4]),m&32&&(h.isLoading=p[5]),d.$set(h)},i(p){_||(te(d.$$.fragment,p),_=!0)},o(p){ie(d.$$.fragment,p),_=!1},d(p){p&&(L(e),L(n),L(l)),Ie(d),t[12](null),y=!1,me(w)}}}function Nn(t){let e,n,l,s,o,i=t[0]&&Wt(t);return{c(){e=T(),i&&i.c(),n=Fe()},m(a,d){C(a,e,d),i&&i.m(a,d),C(a,n,d),l=!0,s||(o=F(document.body,"click",t[9]),s=!0)},p(a,[d]){a[0]?i?(i.p(a,d),d&1&&te(i,1)):(i=Wt(a),i.c(),te(i,1),i.m(n.parentNode,n)):i&&(Ye(),ie(i,1,1,()=>{i=null}),Ze())},i(a){l||(te(i),l=!0)},o(a){ie(i),l=!1},d(a){a&&(L(e),L(n)),i&&i.d(a),s=!1,o()}}}function Cn(t,e,n){let{blogId:l}=e,{magicToken:s}=e,{open:o=!1}=e,{anchorRef:i}=e,{searchTabs:a}=e,{objectType:d}=e,_=[],y=!1,w=!1;const p=()=>{n(0,o=!1)};let m=null;const h=b=>{const I=b.target;o&&ot([i,m],I)&&p()};Lt(async()=>{d&&a.find(b=>b.key===d)||n(1,d=a[0].key)});function v(b){Le[b?"unshift":"push"](()=>{m=b,n(7,m)})}return t.$$set=b=>{"blogId"in b&&n(2,l=b.blogId),"magicToken"in b&&n(3,s=b.magicToken),"open"in b&&n(0,o=b.open),"anchorRef"in b&&n(10,i=b.anchorRef),"searchTabs"in b&&n(4,a=b.searchTabs),"objectType"in b&&n(1,d=b.objectType)},t.$$.update=()=>{t.$$.dirty&3117&&i&&(o?(i.classList.add("open"),!y&&!w&&(n(5,w=!0),at({blogId:l,magicToken:s}).then(b=>{n(6,_=b.contentTypes.filter(I=>I.can_search===1)),n(11,y=!0),n(5,w=!1)}).catch(b=>{console.error("Failed to fetch content types:",b),n(5,w=!1)}))):i.classList.remove("open")),t.$$.dirty&1},[o,d,l,s,a,w,_,m,p,h,i,y,v]}class In extends Oe{constructor(e){super(),Ae(this,e,Cn,Nn,Me,{blogId:2,magicToken:3,open:0,anchorRef:10,searchTabs:4,objectType:1})}}function En(t,e){var n;let l=[];if(t.dataset.searchTabsJson){const o=JSON.parse(t.dataset.searchTabsJson);o.success&&(l=o.data)}const s=new In({target:t,props:{searchTabs:l,objectType:(n=t.dataset.objectType)!==null&&n!==void 0?n:"",...e}});e.anchorRef.addEventListener("click",o=>{o.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,s.$set(e)})}const rt=async t=>{const e={__mode:"filtered_list",blog_id:"0",columns:"name,site_url,parent_website",datasource:"website",items:JSON.stringify(t.items),limit:t.limit,magic_token:t.magicToken,page:t.page,sort_by:"id",sort_order:"descend"};let n,l;try{l=await jQuery.ajax(window.ScriptURI,{type:"POST",contentType:"application/x-www-form-urlencoded; charset=utf-8",data:e,dataType:"json",error:o=>{(o.readyState===0||o.status===0)&&(n="possibly unloaded")}})}catch(o){n??(n=o)}if(n||l.error)return{count:0,page:0,pageMax:0,sites:[]};const s=l.result.objects.map(o=>{const i=o[1].replace(/<span[^>]*>.*?<\/span>\s*<a[^>]*>([^<]+)<\/a>/,"$1").trim();return{id:o[0],name:i,siteUrl:o[2],parentSiteName:o[3]}});return{count:Number.parseInt(l.result.count),page:Number.parseInt(l.result.page),pageMax:Number.parseInt(l.result.page_max),sites:s}},{document:Mn}=Zt;function Dt(t,e,n){const l=t.slice();return l[46]=e[n],l}function Vt(t){let e,n,l,s,o,i,a,d,_,y=window.trans("[_1]Site",t[4].toString())+"",w,p,m,h,v,b,I,J,M,N,q,O,E,P,S,j,U,ne,z,W,R,V,A,D,se,be,de,x,oe,ge,$,Re,ae,ee,H,ue,re,X,f,g,k,Q,Y,G,fe,Ve,we,mt,Ee,Qe,ht,ze,bt,Xe,xe,Be,ce,_e,pe,$e,gt;G=new De({props:{title:window.trans("Search"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_search`}});const yt=[Un,jn],ke=[];function wt(B,le){return B[2]?0:1}return ce=wt(t),_e=ke[ce]=yt[ce](t),{c(){e=u("div"),n=T(),l=u("div"),s=u("div"),o=u("div"),i=u("div"),a=u("div"),d=u("span"),_=K("("),w=K(y),p=K(")"),m=T(),h=u("p"),h.textContent=`${window.trans("Site List")}`,v=T(),b=u("div"),I=u("button"),I.innerHTML='<span aria-hidden="true">\xD7</span>',J=T(),M=u("div"),N=u("div"),q=u("button"),O=K("<<"),P=T(),S=u("button"),j=K("<"),ne=T(),z=u("span"),W=u("span"),R=K(t[5]),V=K("/"),A=K(t[6]),D=T(),se=u("button"),be=K(">"),x=T(),oe=u("button"),ge=K(">>"),Re=T(),ae=u("div"),ee=u("div"),H=u("select"),ue=u("option"),ue.textContent=`${window.trans("Parent Sites")}`,re=u("option"),re.textContent=`${window.trans("Parent and child sites")}`,X=u("option"),X.textContent=`${window.trans("Only child sites")}`,f=T(),g=u("div"),k=u("input"),Q=T(),Y=u("button"),Pe(G.$$.fragment),fe=T(),Ve=u("div"),we=u("button"),we.innerHTML='<span aria-hidden="true">\xD7</span>',mt=T(),Ee=u("div"),Qe=u("span"),Qe.textContent=`${window.trans("Site Name")}`,ht=T(),ze=u("span"),ze.textContent=`${window.trans("Parent Site")}`,bt=T(),Xe=u("div"),xe=u("table"),Be=u("tbody"),_e.c(),r(e,"class","site-list-button-modal-overlay"),r(I,"type","button"),r(I,"class","close"),r(I,"data-dismiss","modal"),r(I,"aria-label","Close"),r(b,"class","d-block d-md-none"),r(a,"class","site-list-title"),r(q,"type","button"),q.disabled=E=t[5]<=1,r(S,"type","button"),S.disabled=U=t[5]<=1,r(W,"class","current"),r(z,"class","page-num"),r(se,"type","button"),se.disabled=de=t[5]===t[6],r(oe,"type","button"),oe.disabled=$=t[5]===t[6],r(N,"class","prev-next"),ue.__value="parent_sites",he(ue,ue.__value),re.__value="parent_and_child_sites",he(re,re.__value),X.__value="child_sites_only",he(X,X.__value),r(H,"class","custom-select form-control form-select"),t[7]===void 0&&Ge(()=>t[29].call(H)),r(ee,"class","site-type-filter"),r(k,"type","text"),r(k,"placeholder",window.trans("Filter by site name")),r(g,"class","site-name-filter"),r(ae,"class","site-filter-actions"),r(we,"type","button"),r(we,"class","close"),r(we,"data-dismiss","modal"),r(we,"aria-label","Close"),r(Ve,"class","d-none d-md-block"),r(M,"class","site-list-actions"),r(i,"class","site-list-header"),r(Qe,"class","table-header-col site-list-header-name"),r(ze,"class","table-header-col site-list-header-parent"),r(Ee,"class","site-list-table-header"),r(Xe,"class","site-list-table-wrapper"),r(o,"class","site-list-container"),r(s,"class","modal-body"),r(l,"class","modal site-list-button-modal")},m(B,le){C(B,e,le),C(B,n,le),C(B,l,le),c(l,s),c(s,o),c(o,i),c(i,a),c(a,d),c(d,_),c(d,w),c(d,p),c(a,m),c(a,h),c(a,v),c(a,b),c(b,I),c(i,J),c(i,M),c(M,N),c(N,q),c(q,O),c(N,P),c(N,S),c(S,j),c(N,ne),c(N,z),c(z,W),c(W,R),c(z,V),c(z,A),c(N,D),c(N,se),c(se,be),c(N,x),c(N,oe),c(oe,ge),c(M,Re),c(M,ae),c(ae,ee),c(ee,H),c(H,ue),c(H,re),c(H,X),Tt(H,t[7],!0),c(ae,f),c(ae,g),c(g,k),he(k,t[8]),c(g,Q),c(g,Y),Ce(G,Y,null),c(M,fe),c(M,Ve),c(Ve,we),c(o,mt),c(o,Ee),c(Ee,Qe),c(Ee,ht),c(Ee,ze),c(o,bt),c(o,Xe),c(Xe,xe),c(xe,Be),ke[ce].m(Be,null),t[36](Be),t[37](l),pe=!0,$e||(gt=[F(e,"click",t[11]),ve(He.call(null,e,"body")),ve(Pt.call(null,e)),F(I,"click",t[11]),F(q,"click",t[15]),F(q,"keydown",t[25]),F(S,"click",t[14]),F(S,"keydown",t[26]),F(se,"click",t[12]),F(se,"keydown",t[27]),F(oe,"click",t[13]),F(oe,"keydown",t[28]),F(H,"change",t[29]),F(H,"change",t[16]),F(k,"input",t[30]),F(k,"keydown",t[31]),F(Y,"click",t[16]),F(we,"click",t[11]),ve(He.call(null,l,"body"))],$e=!0)},p(B,le){(!pe||le[0]&16)&&y!==(y=window.trans("[_1]Site",B[4].toString())+"")&&Se(w,y),(!pe||le[0]&32&&E!==(E=B[5]<=1))&&(q.disabled=E),(!pe||le[0]&32&&U!==(U=B[5]<=1))&&(S.disabled=U),(!pe||le[0]&32)&&Se(R,B[5]),(!pe||le[0]&64)&&Se(A,B[6]),(!pe||le[0]&96&&de!==(de=B[5]===B[6]))&&(se.disabled=de),(!pe||le[0]&96&&$!==($=B[5]===B[6]))&&(oe.disabled=$),le[0]&128&&Tt(H,B[7]),le[0]&256&&k.value!==B[8]&&he(k,B[8]);let et=ce;ce=wt(B),ce===et?ke[ce].p(B,le):(Ye(),ie(ke[et],1,1,()=>{ke[et]=null}),Ze(),_e=ke[ce],_e?_e.p(B,le):(_e=ke[ce]=yt[ce](B),_e.c()),te(_e,1),_e.m(Be,null))},i(B){pe||(te(G.$$.fragment,B),te(_e),pe=!0)},o(B){ie(G.$$.fragment,B),ie(_e),pe=!1},d(B){B&&(L(e),L(n),L(l)),Ie(G),ke[ce].d(),t[36](null),t[37](null),$e=!1,me(gt)}}}function jn(t){let e=[],n=new Map,l,s,o=Te(t[1]);const i=a=>a[46].id;for(let a=0;a<o.length;a+=1){let d=Dt(t,o,a),_=i(d);n.set(_,e[a]=zt(_,d))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();l=Fe()},m(a,d){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(a,d);C(a,l,d),s=!0},p(a,d){d[0]&393226&&(o=Te(a[1]),Ye(),e=on(e,d,i,1,a,o,n,l.parentNode,sn,zt,l,Dt),Ze())},i(a){if(!s){for(let d=0;d<o.length;d+=1)te(e[d]);s=!0}},o(a){for(let d=0;d<e.length;d+=1)ie(e[d]);s=!1},d(a){a&&L(l);for(let d=0;d<e.length;d+=1)e[d].d(a)}}}function Un(t){let e,n;return{c(){e=u("tr"),n=u("td"),n.textContent=`${window.trans("Loading...")}`,r(n,"colspan","2"),r(n,"class","loading")},m(l,s){C(l,e,s),c(e,n)},p:Z,i:Z,o:Z,d(l){l&&L(e)}}}function qn(t){let e;return{c(){e=u("span"),e.textContent=`${window.trans("Child Site")}`,r(e,"class","badge badge-child-site")},m(n,l){C(n,e,l)},p:Z,d(n){n&&L(e)}}}function Pn(t){let e;return{c(){e=u("span"),e.textContent=`${window.trans("Site")}`,r(e,"class","badge badge-site")},m(n,l){C(n,e,l)},p:Z,d(n){n&&L(e)}}}function An(t){let e,n,l,s;function o(...i){return t[33](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2606",r(e,"aria-label",window.trans("Add to starred sites")),r(e,"aria-pressed","false"),r(e,"title",window.trans("Add to starred sites"))},m(i,a){C(i,e,a),c(e,n),l||(s=F(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&L(e),l=!1,s()}}}function On(t){let e,n,l,s;function o(...i){return t[32](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2605",r(e,"aria-label",window.trans("Remove from starred sites")),r(e,"aria-pressed","true"),r(e,"title",window.trans("Remove from starred sites"))},m(i,a){C(i,e,a),c(e,n),l||(s=F(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&L(e),l=!1,s()}}}function Qt(t){let e,n=t[46].parentSiteName+"";return{c(){e=u("span"),r(e,"class","d-block d-md-none parent-site")},m(l,s){C(l,e,s),e.innerHTML=n},p(l,s){s[0]&2&&n!==(n=l[46].parentSiteName+"")&&(e.innerHTML=n)},d(l){l&&L(e)}}}function Hn(t){let e,n,l,s;function o(...i){return t[35](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2606",r(e,"aria-label",window.trans("Add to starred sites")),r(e,"aria-pressed","false"),r(e,"title",window.trans("Add to starred sites"))},m(i,a){C(i,e,a),c(e,n),l||(s=F(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&L(e),l=!1,s()}}}function Bn(t){let e,n,l,s;function o(...i){return t[34](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2605",r(e,"aria-label",window.trans("Remove from starred sites")),r(e,"aria-pressed","true"),r(e,"title",window.trans("Remove from starred sites"))},m(i,a){C(i,e,a),c(e,n),l||(s=F(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&L(e),l=!1,s()}}}function zt(t,e){let n,l,s,o,i,a,d,_,y,w,p,m,h=e[46].name+"",v,b,I,J,M,N,q,O,E,P,S,j=e[46].parentSiteName+"",U,ne,z,W,R,V,A,D,se,be,de,x;function oe(f,g){return f[46].parentSiteName==="-"?Pn:qn}let ge=oe(e),$=ge(e);function Re(f,g){return g[0]&10&&(a=null),a==null&&(a=!!f[3].includes(Number(f[46].id))),a?On:An}let ae=Re(e,[-1,-1]),ee=ae(e);y=new De({props:{title:window.trans("Move"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_move`,style:"height: 15px;"}});let H=e[46].parentSiteName!=="-"&&Qt(e);O=new De({props:{title:window.trans("View your site."),class:"mt-icon mt-icon--sm",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_permalink`}});function ue(f,g){return g[0]&10&&(W=null),W==null&&(W=!!f[3].includes(Number(f[46].id))),W?Bn:Hn}let re=ue(e,[-1,-1]),X=re(e);return A=new De({props:{title:window.trans("Move"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_move`,style:"height: 15px;"}}),{key:t,first:null,c(){n=u("tr"),l=u("td"),s=u("span"),$.c(),o=T(),i=u("span"),ee.c(),d=T(),_=u("span"),Pe(y.$$.fragment),p=T(),m=u("a"),v=K(h),I=T(),H&&H.c(),J=T(),M=u("a"),N=u("span"),N.textContent=`${window.trans("View your site.")}`,q=T(),Pe(O.$$.fragment),P=T(),S=u("td"),U=T(),ne=u("td"),z=u("span"),X.c(),R=T(),V=u("span"),Pe(A.$$.fragment),se=T(),r(_,"class","site-list-table-sortable-handle"),r(_,"style",w=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"),r(i,"class","site-list-table-action-buttons-mobile"),r(s,"class","site-list-table-bagde-container"),r(m,"href",b=`${window.ScriptURI}?__mode=dashboard&blog_id=${e[46].id}`),r(m,"class","dashboard-link"),r(N,"class","d-inline-block d-md-none"),r(M,"href",E=e[46].siteUrl),r(M,"class","site-link"),r(M,"target","_blank"),r(S,"class","site-list-table-parent-site"),r(V,"class","site-list-table-sortable-handle"),r(V,"style",D=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"),r(z,"class","site-list-table-action-buttons"),r(ne,"class","site-list-table-action"),r(n,"data-site-id",be=e[46].id),r(n,"data-is-starred",de=e[3].includes(Number(e[46].id))||void 0),this.first=n},m(f,g){C(f,n,g),c(n,l),c(l,s),$.m(s,null),c(s,o),c(s,i),ee.m(i,null),c(i,d),c(i,_),Ce(y,_,null),c(l,p),c(l,m),c(m,v),c(l,I),H&&H.m(l,null),c(l,J),c(l,M),c(M,N),c(M,q),Ce(O,M,null),c(n,P),c(n,S),S.innerHTML=j,c(n,U),c(n,ne),c(ne,z),X.m(z,null),c(z,R),c(z,V),Ce(A,V,null),c(n,se),x=!0},p(f,g){e=f,ge===(ge=oe(e))&&$?$.p(e,g):($.d(1),$=ge(e),$&&($.c(),$.m(s,o))),ae===(ae=Re(e,g))&&ee?ee.p(e,g):(ee.d(1),ee=ae(e),ee&&(ee.c(),ee.m(i,d))),(!x||g[0]&10&&w!==(w=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"))&&r(_,"style",w),(!x||g[0]&2)&&h!==(h=e[46].name+"")&&Se(v,h),(!x||g[0]&2&&b!==(b=`${window.ScriptURI}?__mode=dashboard&blog_id=${e[46].id}`))&&r(m,"href",b),e[46].parentSiteName!=="-"?H?H.p(e,g):(H=Qt(e),H.c(),H.m(l,J)):H&&(H.d(1),H=null),(!x||g[0]&2&&E!==(E=e[46].siteUrl))&&r(M,"href",E),(!x||g[0]&2)&&j!==(j=e[46].parentSiteName+"")&&(S.innerHTML=j),re===(re=ue(e,g))&&X?X.p(e,g):(X.d(1),X=re(e),X&&(X.c(),X.m(z,R))),(!x||g[0]&10&&D!==(D=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"))&&r(V,"style",D),(!x||g[0]&2&&be!==(be=e[46].id))&&r(n,"data-site-id",be),(!x||g[0]&10&&de!==(de=e[3].includes(Number(e[46].id))||void 0))&&r(n,"data-is-starred",de)},i(f){x||(te(y.$$.fragment,f),te(O.$$.fragment,f),te(A.$$.fragment,f),x=!0)},o(f){ie(y.$$.fragment,f),ie(O.$$.fragment,f),ie(A.$$.fragment,f),x=!1},d(f){f&&L(n),$.d(),ee.d(),Ie(y),H&&H.d(),Ie(O),X.d(),Ie(A)}}}function Fn(t){let e,n,l,s,o,i=t[0]&&Vt(t);return{c(){e=T(),i&&i.c(),n=Fe()},m(a,d){C(a,e,d),i&&i.m(a,d),C(a,n,d),l=!0,s||(o=F(Mn.body,"click",t[19]),s=!0)},p(a,d){a[0]?i?(i.p(a,d),d[0]&1&&te(i,1)):(i=Vt(a),i.c(),te(i,1),i.m(n.parentNode,n)):i&&(Ye(),ie(i,1,1,()=>{i=null}),Ze())},i(a){l||(te(i),l=!0)},o(a){ie(i),l=!1},d(a){a&&(L(e),L(n)),i&&i.d(a),s=!1,o()}}}function Jn(t,e,n){let{magicToken:l}=e,{limit:s=50}=e,{open:o=!1}=e,{anchorRef:i}=e,{initialStarredSites:a}=e,d=!1;const _=()=>{n(0,o=!1)};let y={},w=[],p=[],m=[],h=a,v=0,b=1,I=1,J="parent_and_child_sites",M="",N=[],q=!1,O=null;const E=()=>{n(5,b++,b),ne()},P=()=>{n(5,b=I),ne()},S=()=>{n(5,b--,b),ne()},j=()=>{n(5,b=1),ne()},U=()=>{w=[],p=h,N=[],J==="child_sites_only"?N=[{type:"parent_website",args:{value:""}}]:J==="parent_sites"&&(N=[{type:"parent_website",args:{value:"1"}}]),n(8,M=M.trim()),M!==""&&N.push({type:"name",args:{string:M,option:"contains"}}),n(5,b=1),ne()},ne=async()=>{if(n(2,q=!0),n(1,m=[]),w.length===0){const f=await rt({magicToken:l,items:N,page:b,limit:s});n(4,v=f.count),n(6,I=f.pageMax),n(5,b=I!==0?f.page:0);const g=[];if(p.forEach(k=>{const Q=f.sites.findIndex(Y=>Number(Y.id)===k);if(Q!==-1)y[k]=f.sites[Q],f.sites.splice(Q,1);else{const Y=y[k];if(!Y)g.push(k);else{const G=Y.parentSiteName.match(/^<a/);(J==="child_sites_only"&&!G||J==="parent_sites"&&G)&&(p=p.filter(fe=>fe!==k))}}}),w=[...f.sites],g.length>0){const k=await rt({magicToken:l,items:[...N,{type:"pack",args:{op:"or",items:g.map(Q=>({type:"id",args:{value:Q,option:"equal"}}))}}],page:0,limit:200});g.forEach(Q=>{const Y=k.sites.findIndex(G=>Number(G.id)===Q);Y!==-1?y[Q]=k.sites[Y]:(p=p.filter(G=>G!==Q),n(3,h=h.filter(G=>G!==Q)))})}for(let k=0;k<s&&k<p.length;k++)m.push(y[p[k]]);for(let k=0;k<w.length&&m.length<s;k++)m.push(w[k])}else{const f=p.length,g=(b-1)*s;for(let k=g;k<f&&m.length<s;k++)m.push(y[p[k]]);for(let k=Math.max(g-f,0);k<v-f&&m.length<s;k++){if(!w[k]){const Q=Math.floor(k/s),Y=await rt({magicToken:l,items:[...N,...p.map(fe=>({type:"id",args:{value:fe,option:"not_equal"}}))],page:Q+1,limit:s}),G=Q*s;for(let fe=0;fe<Y.sites.length;fe++)w[G+fe]=Y.sites[fe]}m.push(w[k])}}n(2,q=!1)},z=async f=>{const g=new FormData;return g.append("__mode","save_starred_sites"),g.append("magic_token",l),f.forEach(k=>{g.append("id",String(k))}),fetch(window.ScriptURI,{method:"POST",body:g,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(k=>k.json()).then(k=>{if(k.error)throw new Error(k.error)})},W=f=>{const g=[...h];n(3,h=f),z(h).catch(k=>{alert(k.message),n(3,h=g)})},R=(f,g)=>{f.stopPropagation(),W([...new Set([...h,Number(g.id)])])},V=(f,g)=>{f.stopPropagation();const k=Number(g.id);W(h.filter(Q=>Q!==k))},A=f=>{const g=f.target;o&&ot([i,O],g)&&_()};let D=null;const se=async()=>{await Et(),D&&jQuery(D).sortable({delay:100,distance:3,items:"tr[data-is-starred]",handle:".site-list-table-sortable-handle",opacity:.8,start(f,g){if(!D)return;const k=document.createElement("tr");k.classList.add("site-list-table-placeholder"),k.innerHTML="<td></td><td class='site-list-table-parent-site'></td><td class='site-list-table-action'></td>",D.insertBefore(k,D.firstChild),g.placeholder.height(g.item.height())},stop(){var f;(f=D?.querySelector(".site-list-table-placeholder"))===null||f===void 0||f.remove()},update:()=>{if(!D)return;const f=[],g=[];D.querySelectorAll("tr[data-site-id]").forEach(Q=>{const Y=Number(Q.dataset.siteId);Q.dataset.isStarred&&g.push(Number(Y)),f.push(m.find(G=>Number(G.id)===Y))}),n(1,m=f);const k=h.findIndex(Q=>g.includes(Q));n(3,h=[...h]),h.splice(k,g.length,...g),W(h)}})},be=f=>f.key==="Enter"&&j(),de=f=>f.key==="Enter"&&S(),x=f=>f.key==="Enter"&&E(),oe=f=>f.key==="Enter"&&P();function ge(){J=en(this),n(7,J)}function $(){M=this.value,n(8,M)}const Re=f=>f.key==="Enter"&&U(),ae=(f,g)=>V(g,f),ee=(f,g)=>R(g,f),H=(f,g)=>V(g,f),ue=(f,g)=>R(g,f);function re(f){Le[f?"unshift":"push"](()=>{D=f,n(10,D)})}function X(f){Le[f?"unshift":"push"](()=>{O=f,n(9,O)})}return t.$$set=f=>{"magicToken"in f&&n(20,l=f.magicToken),"limit"in f&&n(21,s=f.limit),"open"in f&&n(0,o=f.open),"anchorRef"in f&&n(22,i=f.anchorRef),"initialStarredSites"in f&&n(23,a=f.initialStarredSites)},t.$$.update=()=>{t.$$.dirty[0]&20971521&&i&&(o?(i.classList.add("open"),d||(n(24,d=!0),U())):i.classList.remove("open")),t.$$.dirty[0]&7&&m&&m.length>0&&o&&!q&&se()},[o,m,q,h,v,b,I,J,M,O,D,_,E,P,S,j,U,R,V,A,l,s,i,a,d,be,de,x,oe,ge,$,Re,ae,ee,H,ue,re,X]}class Wn extends Oe{constructor(e){super(),Ae(this,e,Jn,Fn,Me,{magicToken:20,limit:21,open:0,anchorRef:22,initialStarredSites:23},null,[-1,-1])}}function Dn(t,e){const n=new Wn({target:t,props:e});e.anchorRef.addEventListener("click",l=>{l.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,n.$set(e)})}function Vn(t,e){var n;let l=[];if(t.dataset.searchTabsJson){const i=JSON.parse(t.dataset.searchTabsJson);i.success&&(l=i.data)}const s={searchTabs:l,objectType:(n=t.dataset.objectType)!==null&&n!==void 0?n:"",contentTypes:e.contentTypes||[],isLoading:!1,...e},o=new Jt({target:t,props:s});t.closest("li[data-is='search-form-button']").addEventListener("click",i=>{i.preventDefault(),s.isLoading=!0,o.$set(s),at({blogId:e.blogId,magicToken:e.magicToken}).then(a=>{const d=a.contentTypes.filter(_=>_.can_search===1);s.contentTypes=d,s.contentTypes.length>0&&s.objectType===""&&(s.objectType="content_data"),s.isLoading=!1,o.$set(s)}).catch(a=>{console.error("Failed to fetch content types:",a),s.isLoading=!1,o.$set(s)})},{once:!0})}var ct,dt;const ut=document.querySelector('[data-is="primary-navigation-toggle"]');if(ut!==null){const t="collapsed",e=sessionStorage.getItem(t);gn(ut,{collapsed:e==="true",buttonRef:ut.getElementsByTagName("button")[0],sessionName:t,isStored:e!==null})}const ft=document.querySelector('[data-script="admin-ui"]');ft===null&&console.error("data-script='admin-ui' is not set");const _t=(ct=ft?.getAttribute("data-blog-id"))!==null&&ct!==void 0?ct:"",ye=(dt=ft?.getAttribute("data-magic-token"))!==null&&dt!==void 0?dt:"";ye===""&&console.error("data-magic-token is not set");const Qn="50",Xt=document.querySelectorAll('[data-is="site-list-button"]');Xt.length>0&&ye!==""&&Xt.forEach(t=>{var e;Dn(t,{magicToken:ye,limit:Number.parseInt(Qn),open:!1,anchorRef:t,initialStarredSites:((e=t.dataset.starredSites)===null||e===void 0?void 0:e.split(",").map(Number).filter(Number.isInteger))||[]})});const Gt=document.querySelectorAll('[data-is="create-button"]'),pt=document.querySelector('[data-is="search-button"]'),zn=document.querySelector("div.mt-modal");Gt.length>0&&ye!==""&&Gt.forEach(t=>{pn({target:t,props:{blog_id:_t,magicToken:ye,open:!1,anchorRef:t,containerRef:zn}})}),pt!==null&&ye!==""&&En(pt,{blogId:_t,magicToken:ye,open:!1,anchorRef:pt});const Kt=document.querySelector('[data-is="search-form"]');Kt!==null&&ye!==""&&Vn(Kt,{blogId:_t,magicToken:ye});
