function Q(){}function wt(t){return t()}function kt(){return Object.create(null)}function he(t){t.forEach(wt)}function tt(t){return typeof t=="function"}function Ee(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Kt(t){return Object.keys(t).length===0}function Me(t){return t&&tt(t.destroy)?t.destroy:Q}const Yt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function r(t,e){t.appendChild(e)}function M(t,e,n){t.insertBefore(e,n||null)}function I(t){t.parentNode&&t.parentNode.removeChild(t)}function nt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function lt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function K(t){return document.createTextNode(t)}function S(){return K(" ")}function Fe(){return K("")}function J(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function c(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function vt(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function Zt(t){let e;return{p(...n){e=n,e.forEach(l=>t.push(l))},r(){e.forEach(n=>t.splice(t.indexOf(n),1))}}}function xt(t){return Array.from(t.childNodes)}function Te(t,e){e=""+e,t.data!==e&&(t.data=e)}function ge(t,e){t.value=e??""}function St(t,e,n){for(let l=0;l<t.options.length;l+=1){const s=t.options[l];if(s.__value===e){s.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function $t(t){const e=t.querySelector(":checked");return e&&e.__value}function Tt(t,e,n){t.classList.toggle(e,!!n)}let Je;function De(t){Je=t}function en(){if(!Je)throw new Error("Function called outside component initialization");return Je}function Rt(t){en().$$.on_mount.push(t)}const je=[],Re=[];let Ue=[];const Nt=[],Ct=Promise.resolve();let it=!1;function Lt(){it||(it=!0,Ct.then(Et))}function It(){return Lt(),Ct}function Ye(t){Ue.push(t)}const st=new Set;let qe=0;function Et(){if(qe!==0)return;const t=Je;do{try{for(;qe<je.length;){const e=je[qe];qe++,De(e),tn(e.$$)}}catch(e){throw je.length=0,qe=0,e}for(De(null),je.length=0,qe=0;Re.length;)Re.pop()();for(let e=0;e<Ue.length;e+=1){const n=Ue[e];st.has(n)||(st.add(n),n())}Ue.length=0}while(je.length);for(;Nt.length;)Nt.pop()();it=!1,st.clear(),De(t)}function tn(t){if(t.fragment!==null){t.update(),he(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ye)}}function nn(t){const e=[],n=[];Ue.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),Ue=e}const Ze=new Set;let Ne;function We(){Ne={r:0,c:[],p:Ne}}function Ve(){Ne.r||he(Ne.c),Ne=Ne.p}function Y(t,e){t&&t.i&&(Ze.delete(t),t.i(e))}function le(t,e,n,l){if(t&&t.o){if(Ze.has(t))return;Ze.add(t),Ne.c.push(()=>{Ze.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function ve(t){return t?.length!==void 0?t:Array.from(t)}function ln(t,e){le(t,1,1,()=>{e.delete(t.key)})}function sn(t,e,n,l,s,o,i,a,d,_,y,w){let m=t.length,k=o.length,h=m;const g={};for(;h--;)g[t[h].key]=h;const p=[],R=new Map,P=new Map,E=[];for(h=k;h--;){const N=w(s,o,h),j=n(N);let T=i.get(j);T?E.push(()=>T.p(N,e)):(T=_(j,N),T.c()),R.set(j,p[h]=T),j in g&&P.set(j,Math.abs(h-g[j]))}const L=new Set,D=new Set;function W(N){Y(N,1),N.m(a,y),i.set(N.key,N),y=N.first,k--}for(;m&&k;){const N=p[k-1],j=t[m-1],T=N.key,q=j.key;N===j?(y=N.first,m--,k--):R.has(q)?!i.has(T)||L.has(T)?W(N):D.has(q)?m--:P.get(T)>P.get(q)?(D.add(T),W(N)):(L.add(q),m--):(d(j,i),m--)}for(;m--;){const N=t[m];R.has(N.key)||d(N,i)}for(;k;)W(p[k-1]);return he(E),p}function Ae(t){t&&t.c()}function Ce(t,e,n){const{fragment:l,after_update:s}=t.$$;l&&l.m(e,n),Ye(()=>{const o=t.$$.on_mount.map(wt).filter(tt);t.$$.on_destroy?t.$$.on_destroy.push(...o):he(o),t.$$.on_mount=[]}),s.forEach(Ye)}function Le(t,e){const n=t.$$;n.fragment!==null&&(nn(n.after_update),he(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function on(t,e){t.$$.dirty[0]===-1&&(je.push(t),Lt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Pe(t,e,n,l,s,o,i=null,a=[-1]){const d=Je;De(t);const _=t.$$={fragment:null,ctx:[],props:o,update:Q,not_equal:s,bound:kt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:kt(),dirty:a,skip_bound:!1,root:e.target||d.$$.root};i&&i(_.root);let y=!1;if(_.ctx=n?n(t,e.props||{},(w,m,...k)=>{const h=k.length?k[0]:m;return _.ctx&&s(_.ctx[w],_.ctx[w]=h)&&(!_.skip_bound&&_.bound[w]&&_.bound[w](h),y&&on(t,w)),m}):[],_.update(),y=!0,he(_.before_update),_.fragment=l?l(_.ctx):!1,e.target){if(e.hydrate){const w=xt(e.target);_.fragment&&_.fragment.l(w),w.forEach(I)}else _.fragment&&_.fragment.c();e.intro&&Y(t.$$.fragment),Ce(t,e.target,e.anchor),Et()}De(d)}class Oe{$$=void 0;$$set=void 0;$destroy(){Le(this,1),this.$destroy=Q}$on(e,n){if(!tt(n))return Q;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const s=l.indexOf(n);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!Kt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const an="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(an);function He(t,e="body"){let n;async function l(o){if(e=o,typeof e=="string"){if(n=document.querySelector(e),n===null&&(await It(),n=document.querySelector(e)),n===null)throw new Error(`No element found matching css selector: "${e}"`)}else if(e instanceof HTMLElement)n=e;else throw new TypeError(`Unknown portal target type: ${e===null?"null":typeof e}. Allowed types: string (CSS selector) or HTMLElement.`);n.appendChild(t),t.hidden=!1}function s(){t.parentNode&&t.parentNode.removeChild(t)}return l(e),{update:l,destroy:s}}function ot(t,e){return!t.some(n=>n&&n.contains(e))}const Mt=async t=>{const e={__mode:"content_types_for_search_action",blog_id:t.blogId,magic_token:t.magicToken};let n,l;try{l=await jQuery.ajax(window.ScriptURI,{type:"POST",contentType:"application/x-www-form-urlencoded; charset=utf-8",data:e,dataType:"json",error:s=>{(s.readyState===0||s.status===0)&&(n="possibly unloaded")}})}catch(s){n??(n=s)}return n||l.result.success!==1?{contentTypes:[]}:{contentTypes:l.result.content_types}};function jt(t,e,n){const l=t.slice();return l[12]=e[n],l}function Ut(t){let e,n,l,s,o,i,a,d,_,y,w,m=window.trans("New [_1] creation",window.trans("Entry"))+"",k,h,g,p,R,P=window.trans("New [_1] creation",window.trans("Page"))+"",E,L,D,W;function N(q,H){if(q[3])return cn;if(q[4].length>0)return rn}let j=N(t),T=j&&j(t);return{c(){e=u("div"),n=u("div"),l=u("button"),l.innerHTML='<span aria-hidden="true">\xD7</span>',s=S(),o=u("div"),T&&T.c(),i=S(),a=u("p"),a.textContent=`${`${window.trans("Entry")}\u30FB${window.trans("Page")}`}`,d=S(),_=u("ul"),y=u("li"),w=u("a"),k=K(m),g=S(),p=u("li"),R=u("a"),E=K(P),c(l,"type","button"),c(l,"class","close"),c(l,"data-dismiss","modal"),c(l,"aria-label","Close"),c(n,"class","modal-header"),c(a,"class","block-title"),c(w,"href",h=`${window.CMSScriptURI}?__mode=view&_type=entry&blog_id=${t[1]}`),c(R,"href",L=`${window.CMSScriptURI}?__mode=view&_type=page&blog_id=${t[1]}`),c(_,"class","create-button-list"),c(o,"class","modal-body"),c(e,"class","modal create-button-modal")},m(q,H){M(q,e,H),r(e,n),r(n,l),r(e,s),r(e,o),T&&T.m(o,null),r(o,i),r(o,a),r(o,d),r(o,_),r(_,y),r(y,w),r(w,k),r(_,g),r(_,p),r(p,R),r(R,E),t[11](e),D||(W=[J(l,"click",t[5]),Me(He.call(null,e,"body"))],D=!0)},p(q,H){j===(j=N(q))&&T?T.p(q,H):(T&&T.d(1),T=j&&j(q),T&&(T.c(),T.m(o,i))),H&2&&h!==(h=`${window.CMSScriptURI}?__mode=view&_type=entry&blog_id=${q[1]}`)&&c(w,"href",h),H&2&&L!==(L=`${window.CMSScriptURI}?__mode=view&_type=page&blog_id=${q[1]}`)&&c(R,"href",L)},d(q){q&&I(e),T&&T.d(),t[11](null),D=!1,he(W)}}}function rn(t){let e,n,l,s=ve(t[4]),o=[];for(let i=0;i<s.length;i+=1)o[i]=qt(jt(t,s,i));return{c(){e=u("p"),e.textContent=`${window.trans("Content Data")}`,n=S(),l=u("ul");for(let i=0;i<o.length;i+=1)o[i].c();c(e,"class","block-title"),c(l,"class","create-button-list")},m(i,a){M(i,e,a),M(i,n,a),M(i,l,a);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(l,null)},p(i,a){if(a&18){s=ve(i[4]);let d;for(d=0;d<s.length;d+=1){const _=jt(i,s,d);o[d]?o[d].p(_,a):(o[d]=qt(_),o[d].c(),o[d].m(l,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(i){i&&(I(e),I(n),I(l)),nt(o,i)}}}function cn(t){let e;return{c(){e=u("p"),e.textContent=`${window.trans("Loading...")}`},m(n,l){M(n,e,l)},p:Q,d(n){n&&I(e)}}}function qt(t){let e,n,l=window.trans("New [_1] creation",t[12].name)+"",s,o,i;return{c(){e=u("li"),n=u("a"),s=K(l),i=S(),c(n,"href",o=`${window.CMSScriptURI}?__mode=view&_type=content_data&content_type_id=${t[12].id}&type=content_data_${t[12].id}&blog_id=${t[1]}`)},m(a,d){M(a,e,d),r(e,n),r(n,s),r(e,i)},p(a,d){d&16&&l!==(l=window.trans("New [_1] creation",a[12].name)+"")&&Te(s,l),d&18&&o!==(o=`${window.CMSScriptURI}?__mode=view&_type=content_data&content_type_id=${a[12].id}&type=content_data_${a[12].id}&blog_id=${a[1]}`)&&c(n,"href",o)},d(a){a&&I(e)}}}function dn(t){let e,n,l,s,o=t[0]&&Ut(t);return{c(){e=S(),o&&o.c(),n=Fe()},m(i,a){M(i,e,a),o&&o.m(i,a),M(i,n,a),l||(s=J(document.body,"click",t[6]),l=!0)},p(i,[a]){i[0]?o?o.p(i,a):(o=Ut(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:Q,o:Q,d(i){i&&(I(e),I(n)),o&&o.d(i),l=!1,s()}}}function un(t,e,n){let{blog_id:l}=e,{magicToken:s}=e,{open:o=!1}=e,{anchorRef:i=null}=e,{containerRef:a=null}=e,d=null,_=!1,y=!1,w=[];const m=()=>{n(0,o=!1)},k=g=>{if(a&&a.classList.contains("show"))return;const p=g.target;o&&ot([i,d],p)&&m()};function h(g){Re[g?"unshift":"push"](()=>{d=g,n(2,d),n(8,i),n(0,o),n(10,_),n(3,y),n(1,l),n(7,s)})}return t.$$set=g=>{"blog_id"in g&&n(1,l=g.blog_id),"magicToken"in g&&n(7,s=g.magicToken),"open"in g&&n(0,o=g.open),"anchorRef"in g&&n(8,i=g.anchorRef),"containerRef"in g&&n(9,a=g.containerRef)},t.$$.update=()=>{if(t.$$.dirty&1423&&i){if(d){const g=i.getBoundingClientRect(),p=`calc(${g.bottom}px + 10px)`;n(2,d.style.top=p,d);const R=`calc(100vh - ${g.bottom}px - 10px - 20px)`;n(2,d.style.maxHeight=R,d)}o?(i.classList.add("open"),!_&&!y&&(n(3,y=!0),Mt({blogId:l,magicToken:s}).then(g=>{n(4,w=g.contentTypes.filter(p=>p.can_create===1)),n(10,_=!0),n(3,y=!1)}).catch(g=>{console.error("Failed to fetch content types:",g),n(3,y=!1)}))):i.classList.remove("open")}},[o,l,d,y,w,m,k,s,i,a,_,h]}class fn extends Oe{constructor(e){super(),Pe(this,e,un,dn,Ee,{blog_id:1,magicToken:7,open:0,anchorRef:8,containerRef:9})}}const _n=({target:t,props:e})=>{const n=new fn({target:t,props:e});t.addEventListener("click",l=>{l.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,n.$set(e)})};function pn(t){let e,n,l,s;return{c(){e=u("div"),c(e,"class","mt-primaryNavigation-overlay"),c(e,"style",n=`display: ${t[0]?"block":"none"}`)},m(o,i){M(o,e,i),l||(s=[Me(He.call(null,e,"body")),J(e,"mouseenter",t[1])],l=!0)},p(o,[i]){i&1&&n!==(n=`display: ${o[0]?"block":"none"}`)&&c(e,"style",n)},i:Q,o:Q,d(o){o&&I(e),l=!1,he(s)}}}function mn(t,e,n){let{buttonRef:l}=e,{collapsed:s=!1}=e,{isStored:o=!1}=e,i=!1;const a=(m,k)=>{const h=document.querySelector('[data-is="content-wrapper"]');k?h.classList.add(m):h.classList.remove(m)},d=()=>{a("collapsed",s)},_=()=>{a("mouseover",i)},y=()=>{var m;s&&(i=!0,_(),(m=document.querySelector('[data-is="primary-navigation"]'))===null||m===void 0||m.addEventListener("mouseleave",w,{once:!0}))},w=()=>{i=!1,_()};return Rt(()=>{o||window.innerWidth<1e3&&n(0,s=!0),window.innerWidth<800&&n(0,s=!0),d()}),t.$$set=m=>{"buttonRef"in m&&n(2,l=m.buttonRef),"collapsed"in m&&n(0,s=m.collapsed),"isStored"in m&&n(3,o=m.isStored)},t.$$.update=()=>{t.$$.dirty&5&&(d(),i=!1,_(),l&&(s?(l.classList.remove("expanded"),l.classList.add("collapsed"),document.body.dataset.isCollapsed="true"):(l.classList.remove("collapsed"),l.classList.add("expanded"),document.body.dataset.isCollapsed="false")))},[s,y,l,o]}class hn extends Oe{constructor(e){super(),Pe(this,e,mn,pn,Ee,{buttonRef:2,collapsed:0,isStored:3})}}function bn(t,e){const n=new hn({target:t,props:{collapsed:e.collapsed,buttonRef:e.buttonRef,isStored:e.isStored}});e.buttonRef.addEventListener("click",()=>{e.buttonRef.classList.contains("collapsed")?e.collapsed=!1:e.collapsed=!0,n.$set(e),sessionStorage.setItem(e.sessionName,e.collapsed.toString())})}function At(t){let e,n;return{c(){e=lt("title"),n=K(t[2])},m(l,s){M(l,e,s),r(e,n)},p(l,s){s&4&&Te(n,l[2])},d(l){l&&I(e)}}}function gn(t){let e,n,l=t[2]&&At(t);return{c(){e=lt("svg"),l&&l.c(),n=lt("use"),vt(n,"xlink:href",t[1]),c(e,"role","img"),c(e,"class",t[0]),c(e,"style",t[3])},m(s,o){M(s,e,o),l&&l.m(e,null),r(e,n)},p(s,[o]){s[2]?l?l.p(s,o):(l=At(s),l.c(),l.m(e,n)):l&&(l.d(1),l=null),o&2&&vt(n,"xlink:href",s[1]),o&1&&c(e,"class",s[0]),o&8&&c(e,"style",s[3])},i:Q,o:Q,d(s){s&&I(e),l&&l.d()}}}function yn(t,e,n){let{class:l}=e,{href:s}=e,{title:o}=e,{style:i=void 0}=e;return t.$$set=a=>{"class"in a&&n(0,l=a.class),"href"in a&&n(1,s=a.href),"title"in a&&n(2,o=a.title),"style"in a&&n(3,i=a.style)},[l,s,o,i]}class Qe extends Oe{constructor(e){super(),Pe(this,e,yn,gn,Ee,{class:0,href:1,title:2,style:3})}}function Pt(t,e,n){const l=t.slice();return l[9]=e[n],l}function Ot(t,e,n){const l=t.slice();return l[12]=e[n],l}function Ht(t){let e,n,l,s=!1,o,i,a,d=t[12].label+"",_,y,w,m,k;return w=Zt(t[7][0]),{c(){e=u("label"),n=u("input"),a=S(),_=K(d),y=S(),c(n,"type","radio"),c(n,"name","type"),n.__value=l=t[12].key,ge(n,n.__value),c(n,"id",o=t[12].key),n.checked=i=t[0]===t[12].key,w.p(n)},m(h,g){M(h,e,g),r(e,n),n.checked=n.__value===t[0],r(e,a),r(e,_),r(e,y),m||(k=J(n,"change",t[6]),m=!0)},p(h,g){g&8&&l!==(l=h[12].key)&&(n.__value=l,ge(n,n.__value),s=!0),g&8&&o!==(o=h[12].key)&&c(n,"id",o),g&9&&i!==(i=h[0]===h[12].key)&&(n.checked=i),(s||g&9)&&(n.checked=n.__value===h[0]),g&8&&d!==(d=h[12].label+"")&&Te(_,d)},d(h){h&&I(e),w.r(),m=!1,k()}}}function wn(t){let e;return{c(){e=u("option"),e.textContent=`${window.trans("No Content Type could be found.")}`,e.__value="",ge(e,e.__value)},m(n,l){M(n,e,l)},p:Q,d(n){n&&I(e)}}}function kn(t){let e,n=ve(t[5]),l=[];for(let s=0;s<n.length;s+=1)l[s]=Bt(Pt(t,n,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Fe()},m(s,o){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(s,o);M(s,e,o)},p(s,o){if(o&32){n=ve(s[5]);let i;for(i=0;i<n.length;i+=1){const a=Pt(s,n,i);l[i]?l[i].p(a,o):(l[i]=Bt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(s){s&&I(e),nt(l,s)}}}function Bt(t){let e,n=t[9].name+"",l;return{c(){e=u("option"),l=K(n),e.__value=t[9].id,ge(e,e.__value)},m(s,o){M(s,e,o),r(e,l)},p:Q,d(s){s&&I(e)}}}function vn(t){let e,n,l,s,o,i,a,d,_,y,w,m,k,h,g,p,R,P,E,L,D,W,N,j,T,q,H,z=ve(t[3]),A=[];for(let C=0;C<z.length;C+=1)A[C]=Ht(Ot(t,z,C));function ie(C,U){return C[5].length>0?kn:wn}let Z=ie(t)(t);return j=new Qe({props:{title:window.trans("Search"),class:"mt-icon mt-icon--sm",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_search`}}),{c(){e=u("form"),n=u("input"),l=S(),s=u("input"),o=S(),i=u("input"),a=S(),d=u("input"),_=S(),y=u("input"),w=S(),m=u("div");for(let C=0;C<A.length;C+=1)A[C].c();k=S(),h=u("div"),g=u("select"),Z.c(),R=S(),P=u("div"),E=u("div"),L=u("input"),D=S(),W=u("div"),N=u("button"),Ae(j.$$.fragment),T=S(),q=u("span"),q.textContent=`${window.trans("Search")}`,c(n,"type","hidden"),c(n,"name","__mode"),n.value="search_replace",c(s,"type","hidden"),c(s,"name","blog_id"),s.value=t[1],c(i,"type","hidden"),c(i,"name","_type"),i.value=t[0],c(d,"type","hidden"),c(d,"name","do_search"),d.value="1",c(y,"type","hidden"),c(y,"name","magic_token"),y.value=t[2],c(m,"class","search-type"),c(g,"class","custom-select form-control form-select"),c(g,"name","content_type_id"),g.disabled=p=t[0]!=="content_data"||t[5].length===0,Tt(g,"disabled",t[0]!=="content_data"),c(h,"class","search-content-type"),c(L,"type","text"),c(L,"placeholder",window.trans("Select target and search text...")),c(L,"name","search"),c(E,"class","search-text-box"),c(N,"type","submit"),c(N,"class","btn btn-primary"),c(W,"class","submit-button"),c(P,"class","search-input-group"),c(e,"class","mt-search-form"),c(e,"method","post"),c(e,"action",window.ScriptURI)},m(C,U){M(C,e,U),r(e,n),r(e,l),r(e,s),r(e,o),r(e,i),r(e,a),r(e,d),r(e,_),r(e,y),r(e,w),r(e,m);for(let O=0;O<A.length;O+=1)A[O]&&A[O].m(m,null);r(e,k),r(e,h),r(h,g),Z.m(g,null),r(e,R),r(e,P),r(P,E),r(E,L),t[8](L),r(P,D),r(P,W),r(W,N),Ce(j,N,null),r(N,T),r(N,q),H=!0},p(C,[U]){if((!H||U&2)&&(s.value=C[1]),(!H||U&1)&&(i.value=C[0]),(!H||U&4)&&(y.value=C[2]),U&9){z=ve(C[3]);let O;for(O=0;O<z.length;O+=1){const ce=Ot(C,z,O);A[O]?A[O].p(ce,U):(A[O]=Ht(ce),A[O].c(),A[O].m(m,null))}for(;O<A.length;O+=1)A[O].d(1);A.length=z.length}Z.p(C,U),(!H||U&1&&p!==(p=C[0]!=="content_data"||C[5].length===0))&&(g.disabled=p),(!H||U&1)&&Tt(g,"disabled",C[0]!=="content_data")},i(C){H||(Y(j.$$.fragment,C),H=!0)},o(C){le(j.$$.fragment,C),H=!1},d(C){C&&I(e),nt(A,C),Z.d(),t[8](null),Le(j)}}}function Sn(t,e,n){let{blogId:l}=e,{magicToken:s}=e,{searchTabs:o=[]}=e,{objectType:i}=e,a=[],d=null;const _=[[]];function y(){i=this.__value,n(0,i)}function w(m){Re[m?"unshift":"push"](()=>{d=m,n(4,d)})}return t.$$set=m=>{"blogId"in m&&n(1,l=m.blogId),"magicToken"in m&&n(2,s=m.magicToken),"searchTabs"in m&&n(3,o=m.searchTabs),"objectType"in m&&n(0,i=m.objectType)},t.$$.update=()=>{t.$$.dirty&16&&d&&d.focus()},[i,l,s,o,d,a,y,_,w]}class Ft extends Oe{constructor(e){super(),Pe(this,e,Sn,vn,Ee,{blogId:1,magicToken:2,searchTabs:3,objectType:0})}}function Jt(t){let e,n,l,s,o,i,a,d,_,y,w,m;const k=[Rn,Tn],h=[];function g(p,R){return p[5]?0:1}return d=g(t),_=h[d]=k[d](t),{c(){e=u("div"),n=S(),l=u("div"),s=u("div"),o=u("button"),o.innerHTML='<span aria-hidden="true">\xD7</span>',i=S(),a=u("div"),_.c(),c(e,"class","search-button-modal-overlay"),c(o,"type","button"),c(o,"class","close"),c(o,"data-dismiss","modal"),c(o,"aria-label","Close"),c(s,"class","modal-header"),c(a,"class","modal-body"),c(l,"class","modal search-button-modal")},m(p,R){M(p,e,R),M(p,n,R),M(p,l,R),r(l,s),r(s,o),r(l,i),r(l,a),h[d].m(a,null),t[12](l),y=!0,w||(m=[J(e,"click",t[8]),Me(He.call(null,e,"body")),J(o,"click",t[8]),Me(He.call(null,l,"body"))],w=!0)},p(p,R){let P=d;d=g(p),d===P?h[d].p(p,R):(We(),le(h[P],1,1,()=>{h[P]=null}),Ve(),_=h[d],_?_.p(p,R):(_=h[d]=k[d](p),_.c()),Y(_,1),_.m(a,null))},i(p){y||(Y(_),y=!0)},o(p){le(_),y=!1},d(p){p&&(I(e),I(n),I(l)),h[d].d(),t[12](null),w=!1,he(m)}}}function Tn(t){let e,n;return e=new Ft({props:{blogId:t[2],magicToken:t[3],contentTypes:t[6],objectType:t[1],searchTabs:t[4]}}),{c(){Ae(e.$$.fragment)},m(l,s){Ce(e,l,s),n=!0},p(l,s){const o={};s&4&&(o.blogId=l[2]),s&8&&(o.magicToken=l[3]),s&64&&(o.contentTypes=l[6]),s&2&&(o.objectType=l[1]),s&16&&(o.searchTabs=l[4]),e.$set(o)},i(l){n||(Y(e.$$.fragment,l),n=!0)},o(l){le(e.$$.fragment,l),n=!1},d(l){Le(e,l)}}}function Rn(t){let e;return{c(){e=u("p"),e.textContent=`${window.trans("Loading...")}`},m(n,l){M(n,e,l)},p:Q,i:Q,o:Q,d(n){n&&I(e)}}}function Nn(t){let e,n,l,s,o,i=t[0]&&Jt(t);return{c(){e=S(),i&&i.c(),n=Fe()},m(a,d){M(a,e,d),i&&i.m(a,d),M(a,n,d),l=!0,s||(o=J(document.body,"click",t[9]),s=!0)},p(a,[d]){a[0]?i?(i.p(a,d),d&1&&Y(i,1)):(i=Jt(a),i.c(),Y(i,1),i.m(n.parentNode,n)):i&&(We(),le(i,1,1,()=>{i=null}),Ve())},i(a){l||(Y(i),l=!0)},o(a){le(i),l=!1},d(a){a&&(I(e),I(n)),i&&i.d(a),s=!1,o()}}}function Cn(t,e,n){let{blogId:l}=e,{magicToken:s}=e,{open:o=!1}=e,{anchorRef:i}=e,{searchTabs:a}=e,{objectType:d}=e,_=[],y=!1,w=!1;const m=()=>{n(0,o=!1)};let k=null;const h=p=>{const R=p.target;o&&ot([i,k],R)&&m()};Rt(async()=>{d&&a.find(p=>p.key===d)||n(1,d=a[0].key)});function g(p){Re[p?"unshift":"push"](()=>{k=p,n(7,k)})}return t.$$set=p=>{"blogId"in p&&n(2,l=p.blogId),"magicToken"in p&&n(3,s=p.magicToken),"open"in p&&n(0,o=p.open),"anchorRef"in p&&n(10,i=p.anchorRef),"searchTabs"in p&&n(4,a=p.searchTabs),"objectType"in p&&n(1,d=p.objectType)},t.$$.update=()=>{t.$$.dirty&3117&&i&&(o?(i.classList.add("open"),!y&&!w&&(n(5,w=!0),Mt({blogId:l,magicToken:s}).then(p=>{n(6,_=p.contentTypes.filter(R=>R.can_search===1)),n(11,y=!0),n(5,w=!1)}).catch(p=>{console.error("Failed to fetch content types:",p),n(5,w=!1)}))):i.classList.remove("open")),t.$$.dirty&1},[o,d,l,s,a,w,_,k,m,h,i,y,g]}class Ln extends Oe{constructor(e){super(),Pe(this,e,Cn,Nn,Ee,{blogId:2,magicToken:3,open:0,anchorRef:10,searchTabs:4,objectType:1})}}function In(t,e){var n;let l=[];if(t.dataset.searchTabsJson){const o=JSON.parse(t.dataset.searchTabsJson);o.success&&(l=o.data)}const s=new Ln({target:t,props:{searchTabs:l,objectType:(n=t.dataset.objectType)!==null&&n!==void 0?n:"",...e}});e.anchorRef.addEventListener("click",o=>{o.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,s.$set(e)})}const at=async t=>{const e={__mode:"filtered_list",blog_id:"0",columns:"name,site_url,parent_website",datasource:"website",items:JSON.stringify(t.items),limit:t.limit,magic_token:t.magicToken,page:t.page,sort_by:"id",sort_order:"descend"};let n,l;try{l=await jQuery.ajax(window.ScriptURI,{type:"POST",contentType:"application/x-www-form-urlencoded; charset=utf-8",data:e,dataType:"json",error:o=>{(o.readyState===0||o.status===0)&&(n="possibly unloaded")}})}catch(o){n??(n=o)}if(n||l.error)return{count:0,page:0,pageMax:0,sites:[]};const s=l.result.objects.map(o=>{const i=o[1].replace(/<span[^>]*>.*?<\/span>\s*<a[^>]*>([^<]+)<\/a>/,"$1").trim();return{id:o[0],name:i,siteUrl:o[2],parentSiteName:o[3]}});return{count:Number.parseInt(l.result.count),page:Number.parseInt(l.result.page),pageMax:Number.parseInt(l.result.page_max),sites:s}},{document:En}=Yt;function Dt(t,e,n){const l=t.slice();return l[46]=e[n],l}function Wt(t){let e,n,l,s,o,i,a,d,_,y=window.trans("[_1]Site",t[4].toString())+"",w,m,k,h,g,p,R,P,E,L,D,W,N,j,T,q,H,z,A,ie,re,Z,C,U,O,ce,ue,$,se,be,ee,Se,oe,te,B,fe,ae,X,f,b,v,V,x,G,_e,ze,we,pt,Ie,Xe,mt,Ge,ht,Ke,xe,Be,de,pe,me,$e,bt;G=new Qe({props:{title:window.trans("Search"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_search`}});const gt=[jn,Mn],ke=[];function yt(F,ne){return F[2]?0:1}return de=yt(t),pe=ke[de]=gt[de](t),{c(){e=u("div"),n=S(),l=u("div"),s=u("div"),o=u("div"),i=u("div"),a=u("div"),d=u("span"),_=K("("),w=K(y),m=K(")"),k=S(),h=u("p"),h.textContent=`${window.trans("Site List")}`,g=S(),p=u("div"),R=u("button"),R.innerHTML='<span aria-hidden="true">\xD7</span>',P=S(),E=u("div"),L=u("div"),D=u("button"),W=K("<<"),j=S(),T=u("button"),q=K("<"),z=S(),A=u("span"),ie=u("span"),re=K(t[5]),Z=K("/"),C=K(t[6]),U=S(),O=u("button"),ce=K(">"),$=S(),se=u("button"),be=K(">>"),Se=S(),oe=u("div"),te=u("div"),B=u("select"),fe=u("option"),fe.textContent=`${window.trans("Parent Sites")}`,ae=u("option"),ae.textContent=`${window.trans("Parent and child sites")}`,X=u("option"),X.textContent=`${window.trans("Only child sites")}`,f=S(),b=u("div"),v=u("input"),V=S(),x=u("button"),Ae(G.$$.fragment),_e=S(),ze=u("div"),we=u("button"),we.innerHTML='<span aria-hidden="true">\xD7</span>',pt=S(),Ie=u("div"),Xe=u("span"),Xe.textContent=`${window.trans("Site Name")}`,mt=S(),Ge=u("span"),Ge.textContent=`${window.trans("Parent Site")}`,ht=S(),Ke=u("div"),xe=u("table"),Be=u("tbody"),pe.c(),c(e,"class","site-list-button-modal-overlay"),c(R,"type","button"),c(R,"class","close"),c(R,"data-dismiss","modal"),c(R,"aria-label","Close"),c(p,"class","d-block d-md-none"),c(a,"class","site-list-title"),c(D,"type","button"),D.disabled=N=t[5]<=1,c(T,"type","button"),T.disabled=H=t[5]<=1,c(ie,"class","current"),c(A,"class","page-num"),c(O,"type","button"),O.disabled=ue=t[5]===t[6],c(se,"type","button"),se.disabled=ee=t[5]===t[6],c(L,"class","prev-next"),fe.__value="parent_sites",ge(fe,fe.__value),ae.__value="parent_and_child_sites",ge(ae,ae.__value),X.__value="child_sites_only",ge(X,X.__value),c(B,"class","custom-select form-control form-select"),t[7]===void 0&&Ye(()=>t[29].call(B)),c(te,"class","site-type-filter"),c(v,"type","text"),c(v,"placeholder",window.trans("Filter by site name")),c(b,"class","site-name-filter"),c(oe,"class","site-filter-actions"),c(we,"type","button"),c(we,"class","close"),c(we,"data-dismiss","modal"),c(we,"aria-label","Close"),c(ze,"class","d-none d-md-block"),c(E,"class","site-list-actions"),c(i,"class","site-list-header"),c(Xe,"class","table-header-col site-list-header-name"),c(Ge,"class","table-header-col site-list-header-parent"),c(Ie,"class","site-list-table-header"),c(Ke,"class","site-list-table-wrapper"),c(o,"class","site-list-container"),c(s,"class","modal-body"),c(l,"class","modal site-list-button-modal")},m(F,ne){M(F,e,ne),M(F,n,ne),M(F,l,ne),r(l,s),r(s,o),r(o,i),r(i,a),r(a,d),r(d,_),r(d,w),r(d,m),r(a,k),r(a,h),r(a,g),r(a,p),r(p,R),r(i,P),r(i,E),r(E,L),r(L,D),r(D,W),r(L,j),r(L,T),r(T,q),r(L,z),r(L,A),r(A,ie),r(ie,re),r(A,Z),r(A,C),r(L,U),r(L,O),r(O,ce),r(L,$),r(L,se),r(se,be),r(E,Se),r(E,oe),r(oe,te),r(te,B),r(B,fe),r(B,ae),r(B,X),St(B,t[7],!0),r(oe,f),r(oe,b),r(b,v),ge(v,t[8]),r(b,V),r(b,x),Ce(G,x,null),r(E,_e),r(E,ze),r(ze,we),r(o,pt),r(o,Ie),r(Ie,Xe),r(Ie,mt),r(Ie,Ge),r(o,ht),r(o,Ke),r(Ke,xe),r(xe,Be),ke[de].m(Be,null),t[36](Be),t[37](l),me=!0,$e||(bt=[J(e,"click",t[11]),Me(He.call(null,e,"body")),J(R,"click",t[11]),J(D,"click",t[15]),J(D,"keydown",t[25]),J(T,"click",t[14]),J(T,"keydown",t[26]),J(O,"click",t[12]),J(O,"keydown",t[27]),J(se,"click",t[13]),J(se,"keydown",t[28]),J(B,"change",t[29]),J(B,"change",t[16]),J(v,"input",t[30]),J(v,"keydown",t[31]),J(x,"click",t[16]),J(we,"click",t[11]),Me(He.call(null,l,"body"))],$e=!0)},p(F,ne){(!me||ne[0]&16)&&y!==(y=window.trans("[_1]Site",F[4].toString())+"")&&Te(w,y),(!me||ne[0]&32&&N!==(N=F[5]<=1))&&(D.disabled=N),(!me||ne[0]&32&&H!==(H=F[5]<=1))&&(T.disabled=H),(!me||ne[0]&32)&&Te(re,F[5]),(!me||ne[0]&64)&&Te(C,F[6]),(!me||ne[0]&96&&ue!==(ue=F[5]===F[6]))&&(O.disabled=ue),(!me||ne[0]&96&&ee!==(ee=F[5]===F[6]))&&(se.disabled=ee),ne[0]&128&&St(B,F[7]),ne[0]&256&&v.value!==F[8]&&ge(v,F[8]);let et=de;de=yt(F),de===et?ke[de].p(F,ne):(We(),le(ke[et],1,1,()=>{ke[et]=null}),Ve(),pe=ke[de],pe?pe.p(F,ne):(pe=ke[de]=gt[de](F),pe.c()),Y(pe,1),pe.m(Be,null))},i(F){me||(Y(G.$$.fragment,F),Y(pe),me=!0)},o(F){le(G.$$.fragment,F),le(pe),me=!1},d(F){F&&(I(e),I(n),I(l)),Le(G),ke[de].d(),t[36](null),t[37](null),$e=!1,he(bt)}}}function Mn(t){let e=[],n=new Map,l,s,o=ve(t[1]);const i=a=>a[46].id;for(let a=0;a<o.length;a+=1){let d=Dt(t,o,a),_=i(d);n.set(_,e[a]=Qt(_,d))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();l=Fe()},m(a,d){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(a,d);M(a,l,d),s=!0},p(a,d){d[0]&393226&&(o=ve(a[1]),We(),e=sn(e,d,i,1,a,o,n,l.parentNode,ln,Qt,l,Dt),Ve())},i(a){if(!s){for(let d=0;d<o.length;d+=1)Y(e[d]);s=!0}},o(a){for(let d=0;d<e.length;d+=1)le(e[d]);s=!1},d(a){a&&I(l);for(let d=0;d<e.length;d+=1)e[d].d(a)}}}function jn(t){let e,n;return{c(){e=u("tr"),n=u("td"),n.textContent=`${window.trans("Loading...")}`,c(n,"colspan","2"),c(n,"class","loading")},m(l,s){M(l,e,s),r(e,n)},p:Q,i:Q,o:Q,d(l){l&&I(e)}}}function Un(t){let e;return{c(){e=u("span"),e.textContent=`${window.trans("Child Site")}`,c(e,"class","badge badge-child-site")},m(n,l){M(n,e,l)},p:Q,d(n){n&&I(e)}}}function qn(t){let e;return{c(){e=u("span"),e.textContent=`${window.trans("Site")}`,c(e,"class","badge badge-site")},m(n,l){M(n,e,l)},p:Q,d(n){n&&I(e)}}}function An(t){let e,n,l,s;function o(...i){return t[33](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2606",c(e,"aria-label",window.trans("Add to starred sites")),c(e,"aria-pressed","false"),c(e,"title",window.trans("Add to starred sites"))},m(i,a){M(i,e,a),r(e,n),l||(s=J(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&I(e),l=!1,s()}}}function Pn(t){let e,n,l,s;function o(...i){return t[32](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2605",c(e,"aria-label",window.trans("Remove from starred sites")),c(e,"aria-pressed","true"),c(e,"title",window.trans("Remove from starred sites"))},m(i,a){M(i,e,a),r(e,n),l||(s=J(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&I(e),l=!1,s()}}}function Vt(t){let e,n=t[46].parentSiteName+"";return{c(){e=u("span"),c(e,"class","d-block d-md-none parent-site")},m(l,s){M(l,e,s),e.innerHTML=n},p(l,s){s[0]&2&&n!==(n=l[46].parentSiteName+"")&&(e.innerHTML=n)},d(l){l&&I(e)}}}function On(t){let e,n,l,s;function o(...i){return t[35](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2606",c(e,"aria-label",window.trans("Add to starred sites")),c(e,"aria-pressed","false"),c(e,"title",window.trans("Add to starred sites"))},m(i,a){M(i,e,a),r(e,n),l||(s=J(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&I(e),l=!1,s()}}}function Hn(t){let e,n,l,s;function o(...i){return t[34](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2605",c(e,"aria-label",window.trans("Remove from starred sites")),c(e,"aria-pressed","true"),c(e,"title",window.trans("Remove from starred sites"))},m(i,a){M(i,e,a),r(e,n),l||(s=J(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&I(e),l=!1,s()}}}function Qt(t,e){let n,l,s,o,i,a,d,_,y,w,m,k,h=e[46].name+"",g,p,R,P,E,L,D,W,N,j,T,q=e[46].parentSiteName+"",H,z,A,ie,re,Z,C,U,O,ce,ue,$;function se(f,b){return f[46].parentSiteName==="-"?qn:Un}let be=se(e),ee=be(e);function Se(f,b){return b[0]&10&&(a=null),a==null&&(a=!!f[3].includes(Number(f[46].id))),a?Pn:An}let oe=Se(e,[-1,-1]),te=oe(e);y=new Qe({props:{title:window.trans("Move"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_move`,style:"height: 15px;"}});let B=e[46].parentSiteName!=="-"&&Vt(e);W=new Qe({props:{title:window.trans("View your site."),class:"mt-icon mt-icon--sm",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_permalink`}});function fe(f,b){return b[0]&10&&(ie=null),ie==null&&(ie=!!f[3].includes(Number(f[46].id))),ie?Hn:On}let ae=fe(e,[-1,-1]),X=ae(e);return C=new Qe({props:{title:window.trans("Move"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_move`,style:"height: 15px;"}}),{key:t,first:null,c(){n=u("tr"),l=u("td"),s=u("span"),ee.c(),o=S(),i=u("span"),te.c(),d=S(),_=u("span"),Ae(y.$$.fragment),m=S(),k=u("a"),g=K(h),R=S(),B&&B.c(),P=S(),E=u("a"),L=u("span"),L.textContent=`${window.trans("View your site.")}`,D=S(),Ae(W.$$.fragment),j=S(),T=u("td"),H=S(),z=u("td"),A=u("span"),X.c(),re=S(),Z=u("span"),Ae(C.$$.fragment),O=S(),c(_,"class","site-list-table-sortable-handle"),c(_,"style",w=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"),c(i,"class","site-list-table-action-buttons-mobile"),c(s,"class","site-list-table-bagde-container"),c(k,"href",p=`${window.ScriptURI}?__mode=dashboard&blog_id=${e[46].id}`),c(k,"class","dashboard-link"),c(L,"class","d-inline-block d-md-none"),c(E,"href",N=e[46].siteUrl),c(E,"class","site-link"),c(E,"target","_blank"),c(T,"class","site-list-table-parent-site"),c(Z,"class","site-list-table-sortable-handle"),c(Z,"style",U=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"),c(A,"class","site-list-table-action-buttons"),c(z,"class","site-list-table-action"),c(n,"data-site-id",ce=e[46].id),c(n,"data-is-starred",ue=e[3].includes(Number(e[46].id))||void 0),this.first=n},m(f,b){M(f,n,b),r(n,l),r(l,s),ee.m(s,null),r(s,o),r(s,i),te.m(i,null),r(i,d),r(i,_),Ce(y,_,null),r(l,m),r(l,k),r(k,g),r(l,R),B&&B.m(l,null),r(l,P),r(l,E),r(E,L),r(E,D),Ce(W,E,null),r(n,j),r(n,T),T.innerHTML=q,r(n,H),r(n,z),r(z,A),X.m(A,null),r(A,re),r(A,Z),Ce(C,Z,null),r(n,O),$=!0},p(f,b){e=f,be===(be=se(e))&&ee?ee.p(e,b):(ee.d(1),ee=be(e),ee&&(ee.c(),ee.m(s,o))),oe===(oe=Se(e,b))&&te?te.p(e,b):(te.d(1),te=oe(e),te&&(te.c(),te.m(i,d))),(!$||b[0]&10&&w!==(w=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"))&&c(_,"style",w),(!$||b[0]&2)&&h!==(h=e[46].name+"")&&Te(g,h),(!$||b[0]&2&&p!==(p=`${window.ScriptURI}?__mode=dashboard&blog_id=${e[46].id}`))&&c(k,"href",p),e[46].parentSiteName!=="-"?B?B.p(e,b):(B=Vt(e),B.c(),B.m(l,P)):B&&(B.d(1),B=null),(!$||b[0]&2&&N!==(N=e[46].siteUrl))&&c(E,"href",N),(!$||b[0]&2)&&q!==(q=e[46].parentSiteName+"")&&(T.innerHTML=q),ae===(ae=fe(e,b))&&X?X.p(e,b):(X.d(1),X=ae(e),X&&(X.c(),X.m(A,re))),(!$||b[0]&10&&U!==(U=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"))&&c(Z,"style",U),(!$||b[0]&2&&ce!==(ce=e[46].id))&&c(n,"data-site-id",ce),(!$||b[0]&10&&ue!==(ue=e[3].includes(Number(e[46].id))||void 0))&&c(n,"data-is-starred",ue)},i(f){$||(Y(y.$$.fragment,f),Y(W.$$.fragment,f),Y(C.$$.fragment,f),$=!0)},o(f){le(y.$$.fragment,f),le(W.$$.fragment,f),le(C.$$.fragment,f),$=!1},d(f){f&&I(n),ee.d(),te.d(),Le(y),B&&B.d(),Le(W),X.d(),Le(C)}}}function Bn(t){let e,n,l,s,o,i=t[0]&&Wt(t);return{c(){e=S(),i&&i.c(),n=Fe()},m(a,d){M(a,e,d),i&&i.m(a,d),M(a,n,d),l=!0,s||(o=J(En.body,"click",t[19]),s=!0)},p(a,d){a[0]?i?(i.p(a,d),d[0]&1&&Y(i,1)):(i=Wt(a),i.c(),Y(i,1),i.m(n.parentNode,n)):i&&(We(),le(i,1,1,()=>{i=null}),Ve())},i(a){l||(Y(i),l=!0)},o(a){le(i),l=!1},d(a){a&&(I(e),I(n)),i&&i.d(a),s=!1,o()}}}function Fn(t,e,n){let{magicToken:l}=e,{limit:s=50}=e,{open:o=!1}=e,{anchorRef:i}=e,{initialStarredSites:a}=e,d=!1;const _=()=>{n(0,o=!1)};let y={},w=[],m=[],k=[],h=a,g=0,p=1,R=1,P="parent_and_child_sites",E="",L=[],D=!1,W=null;const N=()=>{n(5,p++,p),z()},j=()=>{n(5,p=R),z()},T=()=>{n(5,p--,p),z()},q=()=>{n(5,p=1),z()},H=()=>{w=[],m=h,L=[],P==="child_sites_only"?L=[{type:"parent_website",args:{value:""}}]:P==="parent_sites"&&(L=[{type:"parent_website",args:{value:"1"}}]),n(8,E=E.trim()),E!==""&&L.push({type:"name",args:{string:E,option:"contains"}}),n(5,p=1),z()},z=async()=>{if(n(2,D=!0),n(1,k=[]),w.length===0){const f=await at({magicToken:l,items:L,page:p,limit:s});n(4,g=f.count),n(6,R=f.pageMax),n(5,p=R!==0?f.page:0);const b=[];if(m.forEach(v=>{const V=f.sites.findIndex(x=>Number(x.id)===v);if(V!==-1)y[v]=f.sites[V],f.sites.splice(V,1);else{const x=y[v];if(!x)b.push(v);else{const G=x.parentSiteName.match(/^<a/);(P==="child_sites_only"&&!G||P==="parent_sites"&&G)&&(m=m.filter(_e=>_e!==v))}}}),w=[...f.sites],b.length>0){const v=await at({magicToken:l,items:[...L,{type:"pack",args:{op:"or",items:b.map(V=>({type:"id",args:{value:V,option:"equal"}}))}}],page:0,limit:200});b.forEach(V=>{const x=v.sites.findIndex(G=>Number(G.id)===V);x!==-1?y[V]=v.sites[x]:(m=m.filter(G=>G!==V),n(3,h=h.filter(G=>G!==V)))})}for(let v=0;v<s&&v<m.length;v++)k.push(y[m[v]]);for(let v=0;v<w.length&&k.length<s;v++)k.push(w[v])}else{const f=m.length,b=(p-1)*s;for(let v=b;v<f&&k.length<s;v++)k.push(y[m[v]]);for(let v=Math.max(b-f,0);v<g-f&&k.length<s;v++){if(!w[v]){const V=Math.floor(v/s),x=await at({magicToken:l,items:[...L,...m.map(_e=>({type:"id",args:{value:_e,option:"not_equal"}}))],page:V+1,limit:s}),G=V*s;for(let _e=0;_e<x.sites.length;_e++)w[G+_e]=x.sites[_e]}k.push(w[v])}}n(2,D=!1)},A=async f=>{const b=new FormData;return b.append("__mode","save_starred_sites"),b.append("magic_token",l),f.forEach(v=>{b.append("id",String(v))}),fetch(window.ScriptURI,{method:"POST",body:b,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(v=>v.json()).then(v=>{if(v.error)throw new Error(v.error)})},ie=f=>{const b=[...h];n(3,h=f),A(h).catch(v=>{alert(v.message),n(3,h=b)})},re=(f,b)=>{f.stopPropagation(),ie([...new Set([...h,Number(b.id)])])},Z=(f,b)=>{f.stopPropagation();const v=Number(b.id);ie(h.filter(V=>V!==v))},C=f=>{const b=f.target;o&&ot([i,W],b)&&_()};let U=null;const O=async()=>{await It(),U&&jQuery(U).sortable({delay:100,distance:3,items:"tr[data-is-starred]",handle:".site-list-table-sortable-handle",opacity:.8,start(f,b){if(!U)return;const v=document.createElement("tr");v.classList.add("site-list-table-placeholder"),v.innerHTML="<td></td><td class='site-list-table-parent-site'></td><td class='site-list-table-action'></td>",U.insertBefore(v,U.firstChild),b.placeholder.height(b.item.height())},stop(){var f;(f=U?.querySelector(".site-list-table-placeholder"))===null||f===void 0||f.remove()},update:()=>{if(!U)return;const f=[],b=[];U.querySelectorAll("tr[data-site-id]").forEach(V=>{const x=Number(V.dataset.siteId);V.dataset.isStarred&&b.push(Number(x)),f.push(k.find(G=>Number(G.id)===x))}),n(1,k=f);const v=h.findIndex(V=>b.includes(V));n(3,h=[...h]),h.splice(v,b.length,...b),ie(h)}})},ce=f=>f.key==="Enter"&&q(),ue=f=>f.key==="Enter"&&T(),$=f=>f.key==="Enter"&&N(),se=f=>f.key==="Enter"&&j();function be(){P=$t(this),n(7,P)}function ee(){E=this.value,n(8,E)}const Se=f=>f.key==="Enter"&&H(),oe=(f,b)=>Z(b,f),te=(f,b)=>re(b,f),B=(f,b)=>Z(b,f),fe=(f,b)=>re(b,f);function ae(f){Re[f?"unshift":"push"](()=>{U=f,n(10,U)})}function X(f){Re[f?"unshift":"push"](()=>{W=f,n(9,W)})}return t.$$set=f=>{"magicToken"in f&&n(20,l=f.magicToken),"limit"in f&&n(21,s=f.limit),"open"in f&&n(0,o=f.open),"anchorRef"in f&&n(22,i=f.anchorRef),"initialStarredSites"in f&&n(23,a=f.initialStarredSites)},t.$$.update=()=>{t.$$.dirty[0]&20971521&&i&&(o?(i.classList.add("open"),d||(n(24,d=!0),H())):i.classList.remove("open")),t.$$.dirty[0]&7&&k&&k.length>0&&o&&!D&&O()},[o,k,D,h,g,p,R,P,E,W,U,_,N,j,T,q,H,re,Z,C,l,s,i,a,d,ce,ue,$,se,be,ee,Se,oe,te,B,fe,ae,X]}class Jn extends Oe{constructor(e){super(),Pe(this,e,Fn,Bn,Ee,{magicToken:20,limit:21,open:0,anchorRef:22,initialStarredSites:23},null,[-1,-1])}}function Dn(t,e){const n=new Jn({target:t,props:e});e.anchorRef.addEventListener("click",l=>{l.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,n.$set(e)})}function Wn(t,e){var n;let l=[];if(t.dataset.searchTabsJson){const s=JSON.parse(t.dataset.searchTabsJson);s.success&&(l=s.data)}new Ft({target:t,props:{searchTabs:l,objectType:(n=t.dataset.objectType)!==null&&n!==void 0?n:"",...e}})}var rt,ct;const dt=document.querySelector('[data-is="primary-navigation-toggle"]');if(dt!==null){const t="collapsed",e=sessionStorage.getItem(t);bn(dt,{collapsed:e==="true",buttonRef:dt.getElementsByTagName("button")[0],sessionName:t,isStored:e!==null})}const ut=document.querySelector('[data-script="admin-ui"]');ut===null&&console.error("data-script='admin-ui' is not set");const ft=(rt=ut?.getAttribute("data-blog-id"))!==null&&rt!==void 0?rt:"",ye=(ct=ut?.getAttribute("data-magic-token"))!==null&&ct!==void 0?ct:"";ye===""&&console.error("data-magic-token is not set");const Vn="50",zt=document.querySelectorAll('[data-is="site-list-button"]');zt.length>0&&ye!==""&&zt.forEach(t=>{var e;Dn(t,{magicToken:ye,limit:Number.parseInt(Vn),open:!1,anchorRef:t,initialStarredSites:((e=t.dataset.starredSites)===null||e===void 0?void 0:e.split(",").map(Number).filter(Number.isInteger))||[]})});const Xt=document.querySelectorAll('[data-is="create-button"]'),_t=document.querySelector('[data-is="search-button"]'),Qn=document.querySelector("div.mt-modal");Xt.length>0&&ye!==""&&Xt.forEach(t=>{_n({target:t,props:{blog_id:ft,magicToken:ye,open:!1,anchorRef:t,containerRef:Qn}})}),_t!==null&&ye!==""&&In(_t,{blogId:ft,magicToken:ye,open:!1,anchorRef:_t});const Gt=document.querySelector('[data-is="search-form"]');Gt!==null&&ye!==""&&Wn(Gt,{blogId:ft,magicToken:ye});
