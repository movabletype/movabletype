function z(){}function St(t){return t()}function Tt(){return Object.create(null)}function me(t){t.forEach(St)}function nt(t){return typeof t=="function"}function Me(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function tn(t){return Object.keys(t).length===0}function ve(t){return t&&nt(t.destroy)?t.destroy:z}const nn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function c(t,e){t.appendChild(e)}function M(t,e,n){t.insertBefore(e,n||null)}function E(t){t.parentNode&&t.parentNode.removeChild(t)}function lt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function it(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function W(t){return document.createTextNode(t)}function L(){return W(" ")}function Fe(){return W("")}function q(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function d(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ct(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function ln(t){let e;return{p(...n){e=n,e.forEach(l=>t.push(l))},r(){e.forEach(n=>t.splice(t.indexOf(n),1))}}}function sn(t){return Array.from(t.childNodes)}function Se(t,e){e=""+e,t.data!==e&&(t.data=e)}function he(t,e){t.value=e??""}function Ke(t,e,n){for(let l=0;l<t.options.length;l+=1){const s=t.options[l];if(s.__value===e){s.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Rt(t){const e=t.querySelector(":checked");return e&&e.__value}function Lt(t,e,n){t.classList.toggle(e,!!n)}let De;function Je(t){De=t}function on(){if(!De)throw new Error("Function called outside component initialization");return De}function Nt(t){on().$$.on_mount.push(t)}const je=[],Re=[];let Ue=[];const Et=[],It=Promise.resolve();let st=!1;function Mt(){st||(st=!0,It.then(Ut))}function jt(){return Mt(),It}function We(t){Ue.push(t)}const ot=new Set;let Pe=0;function Ut(){if(Pe!==0)return;const t=De;do{try{for(;Pe<je.length;){const e=je[Pe];Pe++,Je(e),an(e.$$)}}catch(e){throw je.length=0,Pe=0,e}for(Je(null),je.length=0,Pe=0;Re.length;)Re.pop()();for(let e=0;e<Ue.length;e+=1){const n=Ue[e];ot.has(n)||(ot.add(n),n())}Ue.length=0}while(je.length);for(;Et.length;)Et.pop()();st=!1,ot.clear(),Je(t)}function an(t){if(t.fragment!==null){t.update(),me(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(We)}}function rn(t){const e=[],n=[];Ue.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),Ue=e}const Ye=new Set;let Le;function Ze(){Le={r:0,c:[],p:Le}}function xe(){Le.r||me(Le.c),Le=Le.p}function Y(t,e){t&&t.i&&(Ye.delete(t),t.i(e))}function $(t,e,n,l){if(t&&t.o){if(Ye.has(t))return;Ye.add(t),Le.c.push(()=>{Ye.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function Te(t){return t?.length!==void 0?t:Array.from(t)}function cn(t,e){$(t,1,1,()=>{e.delete(t.key)})}function dn(t,e,n,l,s,o,i,a,r,f,k,w){let p=t.length,b=o.length,m=p;const S={};for(;m--;)S[t[m].key]=m;const h=[],T=new Map,N=new Map,C=[];for(m=b;m--;){const g=w(s,o,m),U=n(g);let v=i.get(U);v?C.push(()=>v.p(g,e)):(v=f(U,g),v.c()),T.set(U,h[m]=v),U in S&&N.set(U,Math.abs(m-S[U]))}const I=new Set,A=new Set;function j(g){Y(g,1),g.m(a,k),i.set(g.key,g),k=g.first,b--}for(;p&&b;){const g=h[b-1],U=t[p-1],v=g.key,P=U.key;g===U?(k=g.first,p--,b--):T.has(P)?!i.has(v)||I.has(v)?j(g):A.has(P)?p--:N.get(v)>N.get(P)?(A.add(v),j(g)):(I.add(P),p--):(r(U,i),p--)}for(;p--;){const g=t[p];T.has(g.key)||r(g,i)}for(;b;)j(h[b-1]);return me(C),h}function qe(t){t&&t.c()}function Ne(t,e,n){const{fragment:l,after_update:s}=t.$$;l&&l.m(e,n),We(()=>{const o=t.$$.on_mount.map(St).filter(nt);t.$$.on_destroy?t.$$.on_destroy.push(...o):me(o),t.$$.on_mount=[]}),s.forEach(We)}function Ee(t,e){const n=t.$$;n.fragment!==null&&(rn(n.after_update),me(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function un(t,e){t.$$.dirty[0]===-1&&(je.push(t),Mt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ae(t,e,n,l,s,o,i=null,a=[-1]){const r=De;Je(t);const f=t.$$={fragment:null,ctx:[],props:o,update:z,not_equal:s,bound:Tt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(r?r.$$.context:[])),callbacks:Tt(),dirty:a,skip_bound:!1,root:e.target||r.$$.root};i&&i(f.root);let k=!1;if(f.ctx=n?n(t,e.props||{},(w,p,...b)=>{const m=b.length?b[0]:p;return f.ctx&&s(f.ctx[w],f.ctx[w]=m)&&(!f.skip_bound&&f.bound[w]&&f.bound[w](m),k&&un(t,w)),p}):[],f.update(),k=!0,me(f.before_update),f.fragment=l?l(f.ctx):!1,e.target){if(e.hydrate){const w=sn(e.target);f.fragment&&f.fragment.l(w),w.forEach(E)}else f.fragment&&f.fragment.c();e.intro&&Y(t.$$.fragment),Ne(t,e.target,e.anchor),Ut()}Je(r)}class Oe{$$=void 0;$$set=void 0;$destroy(){Ee(this,1),this.$destroy=z}$on(e,n){if(!nt(n))return z;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const s=l.indexOf(n);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!tn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const fn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(fn);function He(t,e="body"){let n;async function l(o){if(e=o,typeof e=="string"){if(n=document.querySelector(e),n===null&&(await jt(),n=document.querySelector(e)),n===null)throw new Error(`No element found matching css selector: "${e}"`)}else if(e instanceof HTMLElement)n=e;else throw new TypeError(`Unknown portal target type: ${e===null?"null":typeof e}. Allowed types: string (CSS selector) or HTMLElement.`);n.appendChild(t),t.hidden=!1}function s(){t.parentNode&&t.parentNode.removeChild(t)}return l(e),{update:l,destroy:s}}function at(t,e){return!t.some(n=>n&&n.contains(e))}const rt=async t=>{const e={__mode:"content_types_for_search_action",blog_id:t.blogId,magic_token:t.magicToken};let n,l;try{l=await jQuery.ajax(window.ScriptURI,{type:"POST",contentType:"application/x-www-form-urlencoded; charset=utf-8",data:e,dataType:"json",error:s=>{(s.readyState===0||s.status===0)&&(n="possibly unloaded")}})}catch(s){n??(n=s)}return n||l.result.success!==1?{contentTypes:[]}:{contentTypes:l.result.content_types}};function Pt(t,e,n){const l=t.slice();return l[12]=e[n],l}function qt(t){let e,n,l,s,o,i,a,r,f,k,w,p=window.trans("New [_1] creation",window.trans("Entry"))+"",b,m,S,h,T,N=window.trans("New [_1] creation",window.trans("Page"))+"",C,I,A,j;function g(P,V){if(P[3])return pn;if(P[4].length>0)return _n}let U=g(t),v=U&&U(t);return{c(){e=u("div"),n=u("div"),l=u("button"),l.innerHTML='<span aria-hidden="true">\xD7</span>',s=L(),o=u("div"),v&&v.c(),i=L(),a=u("p"),a.textContent=`${`${window.trans("Entry")}\u30FB${window.trans("Page")}`}`,r=L(),f=u("ul"),k=u("li"),w=u("a"),b=W(p),S=L(),h=u("li"),T=u("a"),C=W(N),d(l,"type","button"),d(l,"class","close"),d(l,"data-dismiss","modal"),d(l,"aria-label","Close"),d(n,"class","modal-header"),d(a,"class","block-title"),d(w,"href",m=`${window.CMSScriptURI}?__mode=view&_type=entry&blog_id=${t[1]}`),d(T,"href",I=`${window.CMSScriptURI}?__mode=view&_type=page&blog_id=${t[1]}`),d(f,"class","create-button-list"),d(o,"class","modal-body"),d(e,"class","modal create-button-modal")},m(P,V){M(P,e,V),c(e,n),c(n,l),c(e,s),c(e,o),v&&v.m(o,null),c(o,i),c(o,a),c(o,r),c(o,f),c(f,k),c(k,w),c(w,b),c(f,S),c(f,h),c(h,T),c(T,C),t[11](e),A||(j=[q(l,"click",t[5]),ve(He.call(null,e,"body"))],A=!0)},p(P,V){U===(U=g(P))&&v?v.p(P,V):(v&&v.d(1),v=U&&U(P),v&&(v.c(),v.m(o,i))),V&2&&m!==(m=`${window.CMSScriptURI}?__mode=view&_type=entry&blog_id=${P[1]}`)&&d(w,"href",m),V&2&&I!==(I=`${window.CMSScriptURI}?__mode=view&_type=page&blog_id=${P[1]}`)&&d(T,"href",I)},d(P){P&&E(e),v&&v.d(),t[11](null),A=!1,me(j)}}}function _n(t){let e,n,l,s=Te(t[4]),o=[];for(let i=0;i<s.length;i+=1)o[i]=At(Pt(t,s,i));return{c(){e=u("p"),e.textContent=`${window.trans("Content Data")}`,n=L(),l=u("ul");for(let i=0;i<o.length;i+=1)o[i].c();d(e,"class","block-title"),d(l,"class","create-button-list")},m(i,a){M(i,e,a),M(i,n,a),M(i,l,a);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(l,null)},p(i,a){if(a&18){s=Te(i[4]);let r;for(r=0;r<s.length;r+=1){const f=Pt(i,s,r);o[r]?o[r].p(f,a):(o[r]=At(f),o[r].c(),o[r].m(l,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=s.length}},d(i){i&&(E(e),E(n),E(l)),lt(o,i)}}}function pn(t){let e;return{c(){e=u("p"),e.textContent=`${window.trans("Loading...")}`},m(n,l){M(n,e,l)},p:z,d(n){n&&E(e)}}}function At(t){let e,n,l=window.trans("New [_1] creation",t[12].name)+"",s,o,i;return{c(){e=u("li"),n=u("a"),s=W(l),i=L(),d(n,"href",o=`${window.CMSScriptURI}?__mode=view&_type=content_data&content_type_id=${t[12].id}&type=content_data_${t[12].id}&blog_id=${t[1]}`)},m(a,r){M(a,e,r),c(e,n),c(n,s),c(e,i)},p(a,r){r&16&&l!==(l=window.trans("New [_1] creation",a[12].name)+"")&&Se(s,l),r&18&&o!==(o=`${window.CMSScriptURI}?__mode=view&_type=content_data&content_type_id=${a[12].id}&type=content_data_${a[12].id}&blog_id=${a[1]}`)&&d(n,"href",o)},d(a){a&&E(e)}}}function mn(t){let e,n,l,s,o=t[0]&&qt(t);return{c(){e=L(),o&&o.c(),n=Fe()},m(i,a){M(i,e,a),o&&o.m(i,a),M(i,n,a),l||(s=q(document.body,"click",t[6]),l=!0)},p(i,[a]){i[0]?o?o.p(i,a):(o=qt(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:z,o:z,d(i){i&&(E(e),E(n)),o&&o.d(i),l=!1,s()}}}function hn(t,e,n){let{blog_id:l}=e,{magicToken:s}=e,{open:o=!1}=e,{anchorRef:i=null}=e,{containerRef:a=null}=e,r=null,f=!1,k=!1,w=[];const p=()=>{n(0,o=!1)},b=S=>{if(a&&a.classList.contains("show"))return;const h=S.target;o&&at([i,r],h)&&p()};function m(S){Re[S?"unshift":"push"](()=>{r=S,n(2,r),n(8,i),n(0,o),n(10,f),n(3,k),n(1,l),n(7,s)})}return t.$$set=S=>{"blog_id"in S&&n(1,l=S.blog_id),"magicToken"in S&&n(7,s=S.magicToken),"open"in S&&n(0,o=S.open),"anchorRef"in S&&n(8,i=S.anchorRef),"containerRef"in S&&n(9,a=S.containerRef)},t.$$.update=()=>{if(t.$$.dirty&1423&&i){if(r){const S=i.getBoundingClientRect(),h=`calc(${S.bottom}px + 10px)`;n(2,r.style.top=h,r);const T=`calc(100vh - ${S.bottom}px - 10px - 20px)`;n(2,r.style.maxHeight=T,r)}o?(i.classList.add("open"),!f&&!k&&(n(3,k=!0),rt({blogId:l,magicToken:s}).then(S=>{n(4,w=S.contentTypes.filter(h=>h.can_create===1)),n(10,f=!0),n(3,k=!1)}).catch(S=>{console.error("Failed to fetch content types:",S),n(3,k=!1)}))):i.classList.remove("open")}},[o,l,r,k,w,p,b,s,i,a,f,m]}class bn extends Oe{constructor(e){super(),Ae(this,e,hn,mn,Me,{blog_id:1,magicToken:7,open:0,anchorRef:8,containerRef:9})}}const gn=({target:t,props:e})=>{const n=new bn({target:t,props:e});t.addEventListener("click",l=>{l.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,n.$set(e)})},Ot="collapsed",Ht=()=>{const t=sessionStorage.getItem(Ot);return t==="true"?!0:t==="false"?!1:null},yn=t=>{sessionStorage.setItem(Ot,t.toString())},Bt=t=>{t?document.documentElement.classList.add("mt-has-primary-navigation-collapsed"):document.documentElement.classList.remove("mt-has-primary-navigation-collapsed")};function wn(t){let e,n,l,s;return{c(){e=u("div"),d(e,"class","mt-primaryNavigation-overlay"),d(e,"style",n=`display: ${t[0]?"block":"none"}`)},m(o,i){M(o,e,i),l||(s=[ve(He.call(null,e,"body")),q(e,"mouseenter",t[1])],l=!0)},p(o,[i]){i&1&&n!==(n=`display: ${o[0]?"block":"none"}`)&&d(e,"style",n)},i:z,o:z,d(o){o&&E(e),l=!1,me(s)}}}function kn(t,e,n){let{buttonRef:l}=e,{collapsed:s=!1}=e,{isStored:o=!1}=e,i=!1;const a=(p,b)=>{const m=document.querySelector('[data-is="content-wrapper"]');b?m.classList.add(p):m.classList.remove(p)},r=()=>{a("collapsed",s)},f=()=>{a("mouseover",i)},k=()=>{var p;s&&(i=!0,f(),(p=document.querySelector('[data-is="primary-navigation"]'))===null||p===void 0||p.addEventListener("mouseleave",w,{once:!0}))},w=()=>{i=!1,f()};return Nt(()=>{o||window.innerWidth<1e3&&n(0,s=!0),window.innerWidth<800&&n(0,s=!0),r()}),t.$$set=p=>{"buttonRef"in p&&n(2,l=p.buttonRef),"collapsed"in p&&n(0,s=p.collapsed),"isStored"in p&&n(3,o=p.isStored)},t.$$.update=()=>{t.$$.dirty&5&&(r(),i=!1,f(),l&&(s?(l.classList.remove("expanded"),l.classList.add("collapsed"),Bt(!0)):(l.classList.remove("collapsed"),l.classList.add("expanded"),Bt(!1))))},[s,k,l,o]}class vn extends Oe{constructor(e){super(),Ae(this,e,kn,wn,Me,{buttonRef:2,collapsed:0,isStored:3})}}function Sn(t,e){const n=new vn({target:t,props:{collapsed:e.collapsed,buttonRef:e.buttonRef,isStored:Ht()!==null}});e.buttonRef.addEventListener("click",()=>{e.buttonRef.classList.contains("collapsed")?e.collapsed=!1:e.collapsed=!0,n.$set(e),yn(e.collapsed)})}const Ft=t=>{const e=window.innerWidth-document.documentElement.clientWidth;e>0&&document.documentElement.style.setProperty("--scrollbar-width",`${e}px`),t.classList.add("mt-modal-overlay")};function Dt(t){let e,n;return{c(){e=it("title"),n=W(t[2])},m(l,s){M(l,e,s),c(e,n)},p(l,s){s&4&&Se(n,l[2])},d(l){l&&E(e)}}}function Tn(t){let e,n,l=t[2]&&Dt(t);return{c(){e=it("svg"),l&&l.c(),n=it("use"),Ct(n,"xlink:href",t[1]),d(e,"role","img"),d(e,"class",t[0]),d(e,"style",t[3])},m(s,o){M(s,e,o),l&&l.m(e,null),c(e,n)},p(s,[o]){s[2]?l?l.p(s,o):(l=Dt(s),l.c(),l.m(e,n)):l&&(l.d(1),l=null),o&2&&Ct(n,"xlink:href",s[1]),o&1&&d(e,"class",s[0]),o&8&&d(e,"style",s[3])},i:z,o:z,d(s){s&&E(e),l&&l.d()}}}function Cn(t,e,n){let{class:l}=e,{href:s}=e,{title:o}=e,{style:i=void 0}=e;return t.$$set=a=>{"class"in a&&n(0,l=a.class),"href"in a&&n(1,s=a.href),"title"in a&&n(2,o=a.title),"style"in a&&n(3,i=a.style)},[l,s,o,i]}class Ve extends Oe{constructor(e){super(),Ae(this,e,Cn,Tn,Me,{class:0,href:1,title:2,style:3})}}function Jt(t,e,n){const l=t.slice();return l[14]=e[n],l}function Wt(t,e,n){const l=t.slice();return l[17]=e[n],l}function Vt(t){let e,n,l,s=!1,o,i,a,r=t[17].label+"",f,k,w,p,b;return w=ln(t[10][0]),{c(){e=u("label"),n=u("input"),a=L(),f=W(r),k=L(),d(n,"type","radio"),n.__value=l=t[17].key,he(n,n.__value),d(n,"id",o=t[17].key),n.checked=i=t[0]===t[17].key,w.p(n)},m(m,S){M(m,e,S),c(e,n),n.checked=n.__value===t[0],c(e,a),c(e,f),c(e,k),p||(b=q(n,"change",t[9]),p=!0)},p(m,S){S&4&&l!==(l=m[17].key)&&(n.__value=l,he(n,n.__value),s=!0),S&4&&o!==(o=m[17].key)&&d(n,"id",o),S&5&&i!==(i=m[0]===m[17].key)&&(n.checked=i),(s||S&5)&&(n.checked=n.__value===m[0]),S&4&&r!==(r=m[17].label+"")&&Se(f,r)},d(m){m&&E(e),w.r(),p=!1,b()}}}function Rn(t){let e,n,l,s;function o(r,f){return r[1].length>0?En:Nn}let i=o(t),a=i(t);return{c(){e=u("select"),a.c(),d(e,"class","custom-select form-control form-select"),e.disabled=n=t[0]!=="content_data"||t[1].length===0,t[4]===void 0&&We(()=>t[11].call(e)),Lt(e,"disabled",t[0]!=="content_data")},m(r,f){M(r,e,f),a.m(e,null),Ke(e,t[4],!0),l||(s=q(e,"change",t[11]),l=!0)},p(r,f){i===(i=o(r))&&a?a.p(r,f):(a.d(1),a=i(r),a&&(a.c(),a.m(e,null))),f&3&&n!==(n=r[0]!=="content_data"||r[1].length===0)&&(e.disabled=n),f&18&&Ke(e,r[4]),f&1&&Lt(e,"disabled",r[0]!=="content_data")},d(r){r&&E(e),a.d(),l=!1,s()}}}function Ln(t){let e;return{c(){e=u("p"),e.textContent=`${window.trans("Loading...")}`},m(n,l){M(n,e,l)},p:z,d(n){n&&E(e)}}}function Nn(t){let e;return{c(){e=u("option"),e.textContent=`${window.trans("No Content Type could be found.")}`,e.__value="",he(e,e.__value)},m(n,l){M(n,e,l)},p:z,d(n){n&&E(e)}}}function En(t){let e,n=Te(t[1]),l=[];for(let s=0;s<n.length;s+=1)l[s]=Qt(Jt(t,n,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Fe()},m(s,o){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(s,o);M(s,e,o)},p(s,o){if(o&2){n=Te(s[1]);let i;for(i=0;i<n.length;i+=1){const a=Jt(s,n,i);l[i]?l[i].p(a,o):(l[i]=Qt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(s){s&&E(e),lt(l,s)}}}function Qt(t){let e,n=t[14].name+"",l,s;return{c(){e=u("option"),l=W(n),e.__value=s=t[14].id,he(e,e.__value)},m(o,i){M(o,e,i),c(e,l)},p(o,i){i&2&&n!==(n=o[14].name+"")&&Se(l,n),i&2&&s!==(s=o[14].id)&&(e.__value=s,he(e,e.__value))},d(o){o&&E(e)}}}function In(t){let e,n,l,s,o,i,a,r,f,k,w,p,b,m,S,h,T,N=Te(t[2]),C=[];for(let g=0;g<N.length;g+=1)C[g]=Vt(Wt(t,N,g));function I(g,U){return g[3]?Ln:Rn}let A=I(t),j=A(t);return p=new Ve({props:{title:window.trans("Search"),class:"mt-icon mt-icon--sm",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_search`}}),{c(){e=u("div"),n=u("div");for(let g=0;g<C.length;g+=1)C[g].c();l=L(),s=u("div"),j.c(),o=L(),i=u("div"),a=u("div"),r=u("input"),f=L(),k=u("div"),w=u("button"),qe(p.$$.fragment),b=L(),m=u("span"),m.textContent=`${window.trans("Search")}`,d(n,"class","search-type"),d(s,"class","search-content-type"),d(r,"type","text"),d(r,"placeholder",window.trans("Select target and search text...")),d(a,"class","search-text-box"),d(w,"type","button"),d(w,"class","btn btn-primary"),d(k,"class","submit-button"),d(i,"class","search-input-group"),d(e,"class","mt-search-form")},m(g,U){M(g,e,U),c(e,n);for(let v=0;v<C.length;v+=1)C[v]&&C[v].m(n,null);c(e,l),c(e,s),j.m(s,null),c(e,o),c(e,i),c(i,a),c(a,r),t[12](r),c(i,f),c(i,k),c(k,w),Ne(p,w,null),c(w,b),c(w,m),S=!0,h||(T=[q(r,"keydown",t[13]),q(w,"click",t[6])],h=!0)},p(g,[U]){if(U&5){N=Te(g[2]);let v;for(v=0;v<N.length;v+=1){const P=Wt(g,N,v);C[v]?C[v].p(P,U):(C[v]=Vt(P),C[v].c(),C[v].m(n,null))}for(;v<C.length;v+=1)C[v].d(1);C.length=N.length}A===(A=I(g))&&j?j.p(g,U):(j.d(1),j=A(g),j&&(j.c(),j.m(s,null)))},i(g){S||(Y(p.$$.fragment,g),S=!0)},o(g){$(p.$$.fragment,g),S=!1},d(g){g&&E(e),lt(C,g),j.d(),t[12](null),Ee(p),h=!1,me(T)}}}function Mn(t,e,n){let{blogId:l}=e,{magicToken:s}=e,{contentTypes:o=[]}=e,{searchTabs:i=[]}=e,{objectType:a}=e,{isLoading:r=!1}=e,f="",k=null;const w=T=>{T.preventDefault();const N=document.createElement("form");N.method="POST",N.action=window.ScriptURI;const C=(A,j)=>{const g=document.createElement("input");return g.type="hidden",g.name=A,g.value=j,g},I=k?.value.trim()||"";N.appendChild(C("__mode","search_replace")),N.appendChild(C("blog_id",l)),N.appendChild(C("_type",a)),N.appendChild(C("do_search","1")),N.appendChild(C("magic_token",s)),N.appendChild(C("search",I)),N.appendChild(C("content_type_id",f||"")),N.appendChild(C("object_type",a)),document.body.appendChild(N),N.submit()},p=[[]];function b(){a=this.__value,n(0,a)}function m(){f=Rt(this),n(4,f),n(5,k),n(1,o),n(1,o)}function S(T){Re[T?"unshift":"push"](()=>{k=T,n(5,k)})}const h=T=>{T.key==="Enter"&&!T.isComposing&&w(T)};return t.$$set=T=>{"blogId"in T&&n(7,l=T.blogId),"magicToken"in T&&n(8,s=T.magicToken),"contentTypes"in T&&n(1,o=T.contentTypes),"searchTabs"in T&&n(2,i=T.searchTabs),"objectType"in T&&n(0,a=T.objectType),"isLoading"in T&&n(3,r=T.isLoading)},t.$$.update=()=>{t.$$.dirty&50&&(k&&k.focus(),!f&&o.length>0&&n(4,f=o[0].id))},[a,o,i,r,f,k,w,l,s,b,p,m,S,h]}class zt extends Oe{constructor(e){super(),Ae(this,e,Mn,In,Me,{blogId:7,magicToken:8,contentTypes:1,searchTabs:2,objectType:0,isLoading:3})}}function Gt(t){let e,n,l,s,o,i,a,r,f,k,w;return r=new zt({props:{blogId:t[2],magicToken:t[3],contentTypes:t[6],objectType:t[1],searchTabs:t[4],isLoading:t[5]}}),{c(){e=u("div"),n=L(),l=u("div"),s=u("div"),o=u("button"),o.innerHTML='<span aria-hidden="true">\xD7</span>',i=L(),a=u("div"),qe(r.$$.fragment),d(e,"class","search-button-modal-overlay"),d(o,"type","button"),d(o,"class","close"),d(o,"data-dismiss","modal"),d(o,"aria-label","Close"),d(s,"class","modal-header"),d(a,"class","modal-body"),d(l,"class","modal search-button-modal")},m(p,b){M(p,e,b),M(p,n,b),M(p,l,b),c(l,s),c(s,o),c(l,i),c(l,a),Ne(r,a,null),t[12](l),f=!0,k||(w=[q(e,"click",t[8]),ve(He.call(null,e,"body")),ve(Ft.call(null,e)),q(o,"click",t[8]),ve(He.call(null,l,"body"))],k=!0)},p(p,b){const m={};b&4&&(m.blogId=p[2]),b&8&&(m.magicToken=p[3]),b&64&&(m.contentTypes=p[6]),b&2&&(m.objectType=p[1]),b&16&&(m.searchTabs=p[4]),b&32&&(m.isLoading=p[5]),r.$set(m)},i(p){f||(Y(r.$$.fragment,p),f=!0)},o(p){$(r.$$.fragment,p),f=!1},d(p){p&&(E(e),E(n),E(l)),Ee(r),t[12](null),k=!1,me(w)}}}function jn(t){let e,n,l,s,o,i=t[0]&&Gt(t);return{c(){e=L(),i&&i.c(),n=Fe()},m(a,r){M(a,e,r),i&&i.m(a,r),M(a,n,r),l=!0,s||(o=q(document.body,"click",t[9]),s=!0)},p(a,[r]){a[0]?i?(i.p(a,r),r&1&&Y(i,1)):(i=Gt(a),i.c(),Y(i,1),i.m(n.parentNode,n)):i&&(Ze(),$(i,1,1,()=>{i=null}),xe())},i(a){l||(Y(i),l=!0)},o(a){$(i),l=!1},d(a){a&&(E(e),E(n)),i&&i.d(a),s=!1,o()}}}function Un(t,e,n){let{blogId:l}=e,{magicToken:s}=e,{open:o=!1}=e,{anchorRef:i}=e,{searchTabs:a}=e,{objectType:r}=e,f=[],k=!1,w=!1;const p=()=>{n(0,o=!1)};let b=null;const m=h=>{const T=h.target;o&&at([i,b],T)&&p()};Nt(async()=>{r&&a.find(h=>h.key===r)||n(1,r=a[0].key)});function S(h){Re[h?"unshift":"push"](()=>{b=h,n(7,b)})}return t.$$set=h=>{"blogId"in h&&n(2,l=h.blogId),"magicToken"in h&&n(3,s=h.magicToken),"open"in h&&n(0,o=h.open),"anchorRef"in h&&n(10,i=h.anchorRef),"searchTabs"in h&&n(4,a=h.searchTabs),"objectType"in h&&n(1,r=h.objectType)},t.$$.update=()=>{t.$$.dirty&3117&&i&&(o?(i.classList.add("open"),!k&&!w&&(n(5,w=!0),rt({blogId:l,magicToken:s}).then(h=>{n(6,f=h.contentTypes.filter(T=>T.can_search===1)),n(11,k=!0),n(5,w=!1)}).catch(h=>{console.error("Failed to fetch content types:",h),n(5,w=!1)}))):i.classList.remove("open")),t.$$.dirty&1},[o,r,l,s,a,w,f,b,p,m,i,k,S]}class Pn extends Oe{constructor(e){super(),Ae(this,e,Un,jn,Me,{blogId:2,magicToken:3,open:0,anchorRef:10,searchTabs:4,objectType:1})}}function qn(t,e){var n;let l=[];if(t.dataset.searchTabsJson){const o=JSON.parse(t.dataset.searchTabsJson);o.success&&(l=o.data)}const s=new Pn({target:t,props:{searchTabs:l,objectType:(n=t.dataset.objectType)!==null&&n!==void 0?n:"",...e}});e.anchorRef.addEventListener("click",o=>{o.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,s.$set(e)})}const ct=async t=>{const e={__mode:"filtered_list",blog_id:"0",columns:"name,site_url,parent_website",datasource:"website",items:JSON.stringify(t.items),limit:t.limit,magic_token:t.magicToken,page:t.page,sort_by:"id",sort_order:"descend"};let n,l;try{l=await jQuery.ajax(window.ScriptURI,{type:"POST",contentType:"application/x-www-form-urlencoded; charset=utf-8",data:e,dataType:"json",error:o=>{(o.readyState===0||o.status===0)&&(n="possibly unloaded")}})}catch(o){n??(n=o)}if(n||l.error)return{count:0,page:0,pageMax:0,sites:[]};const s=l.result.objects.map(o=>{const i=o[1].replace(/<span[^>]*>.*?<\/span>\s*<a[^>]*>([^<]+)<\/a>/,"$1").trim();return{id:o[0],name:i,siteUrl:o[2],parentSiteName:o[3]}});return{count:Number.parseInt(l.result.count),page:Number.parseInt(l.result.page),pageMax:Number.parseInt(l.result.page_max),sites:s}},{document:An}=nn;function Xt(t,e,n){const l=t.slice();return l[46]=e[n],l}function Kt(t){let e,n,l,s,o,i,a,r,f,k=window.trans("[_1]Site",t[4].toString())+"",w,p,b,m,S,h,T,N,C,I,A,j,g,U,v,P,V,ee,Z,te,ce,ne,ae,F,le,be,de,G,ie,ge,X,Ce,se,K,O,ue,oe,D,_,y,R,B,Q,J,fe,Qe,we,bt,Ie,ze,gt,Ge,yt,Xe,$e,Be,re,_e,pe,et,wt;J=new Ve({props:{title:window.trans("Search"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_search`}});const kt=[Hn,On],ke=[];function vt(H,x){return H[2]?0:1}return re=vt(t),_e=ke[re]=kt[re](t),{c(){e=u("div"),n=L(),l=u("div"),s=u("div"),o=u("div"),i=u("div"),a=u("div"),r=u("span"),f=W("("),w=W(k),p=W(")"),b=L(),m=u("p"),m.textContent=`${window.trans("Site List")}`,S=L(),h=u("div"),T=u("button"),T.innerHTML='<span aria-hidden="true">\xD7</span>',N=L(),C=u("div"),I=u("div"),A=u("button"),j=W("<<"),U=L(),v=u("button"),P=W("<"),ee=L(),Z=u("span"),te=u("span"),ce=W(t[5]),ne=W("/"),ae=W(t[6]),F=L(),le=u("button"),be=W(">"),G=L(),ie=u("button"),ge=W(">>"),Ce=L(),se=u("div"),K=u("div"),O=u("select"),ue=u("option"),ue.textContent=`${window.trans("Parent Sites")}`,oe=u("option"),oe.textContent=`${window.trans("Parent and child sites")}`,D=u("option"),D.textContent=`${window.trans("Only child sites")}`,_=L(),y=u("div"),R=u("input"),B=L(),Q=u("button"),qe(J.$$.fragment),fe=L(),Qe=u("div"),we=u("button"),we.innerHTML='<span aria-hidden="true">\xD7</span>',bt=L(),Ie=u("div"),ze=u("span"),ze.textContent=`${window.trans("Site Name")}`,gt=L(),Ge=u("span"),Ge.textContent=`${window.trans("Parent Site")}`,yt=L(),Xe=u("div"),$e=u("table"),Be=u("tbody"),_e.c(),d(e,"class","site-list-button-modal-overlay"),d(T,"type","button"),d(T,"class","close"),d(T,"data-dismiss","modal"),d(T,"aria-label","Close"),d(h,"class","d-block d-md-none"),d(a,"class","site-list-title"),d(A,"type","button"),A.disabled=g=t[5]<=1,d(v,"type","button"),v.disabled=V=t[5]<=1,d(te,"class","current"),d(Z,"class","page-num"),d(le,"type","button"),le.disabled=de=t[5]===t[6],d(ie,"type","button"),ie.disabled=X=t[5]===t[6],d(I,"class","prev-next"),ue.__value="parent_sites",he(ue,ue.__value),oe.__value="parent_and_child_sites",he(oe,oe.__value),D.__value="child_sites_only",he(D,D.__value),d(O,"class","custom-select form-control form-select"),t[7]===void 0&&We(()=>t[29].call(O)),d(K,"class","site-type-filter"),d(R,"type","text"),d(R,"placeholder",window.trans("Filter by site name")),d(y,"class","site-name-filter"),d(se,"class","site-filter-actions"),d(we,"type","button"),d(we,"class","close"),d(we,"data-dismiss","modal"),d(we,"aria-label","Close"),d(Qe,"class","d-none d-md-block"),d(C,"class","site-list-actions"),d(i,"class","site-list-header"),d(ze,"class","table-header-col site-list-header-name"),d(Ge,"class","table-header-col site-list-header-parent"),d(Ie,"class","site-list-table-header"),d(Xe,"class","site-list-table-wrapper"),d(o,"class","site-list-container"),d(s,"class","modal-body"),d(l,"class","modal site-list-button-modal")},m(H,x){M(H,e,x),M(H,n,x),M(H,l,x),c(l,s),c(s,o),c(o,i),c(i,a),c(a,r),c(r,f),c(r,w),c(r,p),c(a,b),c(a,m),c(a,S),c(a,h),c(h,T),c(i,N),c(i,C),c(C,I),c(I,A),c(A,j),c(I,U),c(I,v),c(v,P),c(I,ee),c(I,Z),c(Z,te),c(te,ce),c(Z,ne),c(Z,ae),c(I,F),c(I,le),c(le,be),c(I,G),c(I,ie),c(ie,ge),c(C,Ce),c(C,se),c(se,K),c(K,O),c(O,ue),c(O,oe),c(O,D),Ke(O,t[7],!0),c(se,_),c(se,y),c(y,R),he(R,t[8]),c(y,B),c(y,Q),Ne(J,Q,null),c(C,fe),c(C,Qe),c(Qe,we),c(o,bt),c(o,Ie),c(Ie,ze),c(Ie,gt),c(Ie,Ge),c(o,yt),c(o,Xe),c(Xe,$e),c($e,Be),ke[re].m(Be,null),t[36](Be),t[37](l),pe=!0,et||(wt=[q(e,"click",t[11]),ve(He.call(null,e,"body")),ve(Ft.call(null,e)),q(T,"click",t[11]),q(A,"click",t[15]),q(A,"keydown",t[25]),q(v,"click",t[14]),q(v,"keydown",t[26]),q(le,"click",t[12]),q(le,"keydown",t[27]),q(ie,"click",t[13]),q(ie,"keydown",t[28]),q(O,"change",t[29]),q(O,"change",t[16]),q(R,"input",t[30]),q(R,"keydown",t[31]),q(Q,"click",t[16]),q(we,"click",t[11]),ve(He.call(null,l,"body"))],et=!0)},p(H,x){(!pe||x[0]&16)&&k!==(k=window.trans("[_1]Site",H[4].toString())+"")&&Se(w,k),(!pe||x[0]&32&&g!==(g=H[5]<=1))&&(A.disabled=g),(!pe||x[0]&32&&V!==(V=H[5]<=1))&&(v.disabled=V),(!pe||x[0]&32)&&Se(ce,H[5]),(!pe||x[0]&64)&&Se(ae,H[6]),(!pe||x[0]&96&&de!==(de=H[5]===H[6]))&&(le.disabled=de),(!pe||x[0]&96&&X!==(X=H[5]===H[6]))&&(ie.disabled=X),x[0]&128&&Ke(O,H[7]),x[0]&256&&R.value!==H[8]&&he(R,H[8]);let tt=re;re=vt(H),re===tt?ke[re].p(H,x):(Ze(),$(ke[tt],1,1,()=>{ke[tt]=null}),xe(),_e=ke[re],_e?_e.p(H,x):(_e=ke[re]=kt[re](H),_e.c()),Y(_e,1),_e.m(Be,null))},i(H){pe||(Y(J.$$.fragment,H),Y(_e),pe=!0)},o(H){$(J.$$.fragment,H),$(_e),pe=!1},d(H){H&&(E(e),E(n),E(l)),Ee(J),ke[re].d(),t[36](null),t[37](null),et=!1,me(wt)}}}function On(t){let e=[],n=new Map,l,s,o=Te(t[1]);const i=a=>a[46].id;for(let a=0;a<o.length;a+=1){let r=Xt(t,o,a),f=i(r);n.set(f,e[a]=Zt(f,r))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();l=Fe()},m(a,r){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(a,r);M(a,l,r),s=!0},p(a,r){r[0]&393226&&(o=Te(a[1]),Ze(),e=dn(e,r,i,1,a,o,n,l.parentNode,cn,Zt,l,Xt),xe())},i(a){if(!s){for(let r=0;r<o.length;r+=1)Y(e[r]);s=!0}},o(a){for(let r=0;r<e.length;r+=1)$(e[r]);s=!1},d(a){a&&E(l);for(let r=0;r<e.length;r+=1)e[r].d(a)}}}function Hn(t){let e,n;return{c(){e=u("tr"),n=u("td"),n.textContent=`${window.trans("Loading...")}`,d(n,"colspan","2"),d(n,"class","loading")},m(l,s){M(l,e,s),c(e,n)},p:z,i:z,o:z,d(l){l&&E(e)}}}function Bn(t){let e;return{c(){e=u("span"),e.textContent=`${window.trans("Child Site")}`,d(e,"class","badge badge-child-site")},m(n,l){M(n,e,l)},p:z,d(n){n&&E(e)}}}function Fn(t){let e;return{c(){e=u("span"),e.textContent=`${window.trans("Site")}`,d(e,"class","badge badge-site")},m(n,l){M(n,e,l)},p:z,d(n){n&&E(e)}}}function Dn(t){let e,n,l,s;function o(...i){return t[33](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2606",d(e,"aria-label",window.trans("Add to starred sites")),d(e,"aria-pressed","false"),d(e,"title",window.trans("Add to starred sites"))},m(i,a){M(i,e,a),c(e,n),l||(s=q(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&E(e),l=!1,s()}}}function Jn(t){let e,n,l,s;function o(...i){return t[32](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2605",d(e,"aria-label",window.trans("Remove from starred sites")),d(e,"aria-pressed","true"),d(e,"title",window.trans("Remove from starred sites"))},m(i,a){M(i,e,a),c(e,n),l||(s=q(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&E(e),l=!1,s()}}}function Yt(t){let e,n=t[46].parentSiteName+"";return{c(){e=u("span"),d(e,"class","d-block d-md-none parent-site")},m(l,s){M(l,e,s),e.innerHTML=n},p(l,s){s[0]&2&&n!==(n=l[46].parentSiteName+"")&&(e.innerHTML=n)},d(l){l&&E(e)}}}function Wn(t){let e,n,l,s;function o(...i){return t[35](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2606",d(e,"aria-label",window.trans("Add to starred sites")),d(e,"aria-pressed","false"),d(e,"title",window.trans("Add to starred sites"))},m(i,a){M(i,e,a),c(e,n),l||(s=q(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&E(e),l=!1,s()}}}function Vn(t){let e,n,l,s;function o(...i){return t[34](t[46],...i)}return{c(){e=u("button"),n=u("span"),n.textContent="\u2605",d(e,"aria-label",window.trans("Remove from starred sites")),d(e,"aria-pressed","true"),d(e,"title",window.trans("Remove from starred sites"))},m(i,a){M(i,e,a),c(e,n),l||(s=q(e,"click",o),l=!0)},p(i,a){t=i},d(i){i&&E(e),l=!1,s()}}}function Zt(t,e){let n,l,s,o,i,a,r,f,k,w,p,b,m=e[46].name+"",S,h,T,N,C,I,A,j,g,U,v,P=e[46].parentSiteName+"",V,ee,Z,te,ce,ne,ae,F,le,be,de,G;function ie(_,y){return _[46].parentSiteName==="-"?Fn:Bn}let ge=ie(e),X=ge(e);function Ce(_,y){return y[0]&10&&(a=null),a==null&&(a=!!_[3].includes(Number(_[46].id))),a?Jn:Dn}let se=Ce(e,[-1,-1]),K=se(e);k=new Ve({props:{title:window.trans("Move"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_move`,style:"height: 15px;"}});let O=e[46].parentSiteName!=="-"&&Yt(e);j=new Ve({props:{title:window.trans("View your site."),class:"mt-icon mt-icon--sm",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_permalink`}});function ue(_,y){return y[0]&10&&(te=null),te==null&&(te=!!_[3].includes(Number(_[46].id))),te?Vn:Wn}let oe=ue(e,[-1,-1]),D=oe(e);return ae=new Ve({props:{title:window.trans("Move"),class:"mt-icon",href:`${window.StaticURI}images/admin2025/sprite.svg#ic_move`,style:"height: 15px;"}}),{key:t,first:null,c(){n=u("tr"),l=u("td"),s=u("span"),X.c(),o=L(),i=u("span"),K.c(),r=L(),f=u("span"),qe(k.$$.fragment),p=L(),b=u("a"),S=W(m),T=L(),O&&O.c(),N=L(),C=u("a"),I=u("span"),I.textContent=`${window.trans("View your site.")}`,A=L(),qe(j.$$.fragment),U=L(),v=u("td"),V=L(),ee=u("td"),Z=u("span"),D.c(),ce=L(),ne=u("span"),qe(ae.$$.fragment),le=L(),d(f,"class","site-list-table-sortable-handle"),d(f,"style",w=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"),d(i,"class","site-list-table-action-buttons-mobile"),d(s,"class","site-list-table-bagde-container"),d(b,"href",h=`${window.ScriptURI}?__mode=dashboard&blog_id=${e[46].id}`),d(b,"class","dashboard-link"),d(I,"class","d-inline-block d-md-none"),d(C,"href",g=e[46].siteUrl),d(C,"class","site-link"),d(C,"target","_blank"),d(v,"class","site-list-table-parent-site"),d(ne,"class","site-list-table-sortable-handle"),d(ne,"style",F=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"),d(Z,"class","site-list-table-action-buttons"),d(ee,"class","site-list-table-action"),d(n,"data-site-id",be=e[46].id),d(n,"data-is-starred",de=e[3].includes(Number(e[46].id))||void 0),this.first=n},m(_,y){M(_,n,y),c(n,l),c(l,s),X.m(s,null),c(s,o),c(s,i),K.m(i,null),c(i,r),c(i,f),Ne(k,f,null),c(l,p),c(l,b),c(b,S),c(l,T),O&&O.m(l,null),c(l,N),c(l,C),c(C,I),c(C,A),Ne(j,C,null),c(n,U),c(n,v),v.innerHTML=P,c(n,V),c(n,ee),c(ee,Z),D.m(Z,null),c(Z,ce),c(Z,ne),Ne(ae,ne,null),c(n,le),G=!0},p(_,y){e=_,ge===(ge=ie(e))&&X?X.p(e,y):(X.d(1),X=ge(e),X&&(X.c(),X.m(s,o))),se===(se=Ce(e,y))&&K?K.p(e,y):(K.d(1),K=se(e),K&&(K.c(),K.m(i,r))),(!G||y[0]&10&&w!==(w=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"))&&d(f,"style",w),(!G||y[0]&2)&&m!==(m=e[46].name+"")&&Se(S,m),(!G||y[0]&2&&h!==(h=`${window.ScriptURI}?__mode=dashboard&blog_id=${e[46].id}`))&&d(b,"href",h),e[46].parentSiteName!=="-"?O?O.p(e,y):(O=Yt(e),O.c(),O.m(l,N)):O&&(O.d(1),O=null),(!G||y[0]&2&&g!==(g=e[46].siteUrl))&&d(C,"href",g),(!G||y[0]&2)&&P!==(P=e[46].parentSiteName+"")&&(v.innerHTML=P),oe===(oe=ue(e,y))&&D?D.p(e,y):(D.d(1),D=oe(e),D&&(D.c(),D.m(Z,ce))),(!G||y[0]&10&&F!==(F=e[3].includes(Number(e[46].id))?"cursor: move":"visibility: hidden;"))&&d(ne,"style",F),(!G||y[0]&2&&be!==(be=e[46].id))&&d(n,"data-site-id",be),(!G||y[0]&10&&de!==(de=e[3].includes(Number(e[46].id))||void 0))&&d(n,"data-is-starred",de)},i(_){G||(Y(k.$$.fragment,_),Y(j.$$.fragment,_),Y(ae.$$.fragment,_),G=!0)},o(_){$(k.$$.fragment,_),$(j.$$.fragment,_),$(ae.$$.fragment,_),G=!1},d(_){_&&E(n),X.d(),K.d(),Ee(k),O&&O.d(),Ee(j),D.d(),Ee(ae)}}}function Qn(t){let e,n,l,s,o,i=t[0]&&Kt(t);return{c(){e=L(),i&&i.c(),n=Fe()},m(a,r){M(a,e,r),i&&i.m(a,r),M(a,n,r),l=!0,s||(o=q(An.body,"click",t[19]),s=!0)},p(a,r){a[0]?i?(i.p(a,r),r[0]&1&&Y(i,1)):(i=Kt(a),i.c(),Y(i,1),i.m(n.parentNode,n)):i&&(Ze(),$(i,1,1,()=>{i=null}),xe())},i(a){l||(Y(i),l=!0)},o(a){$(i),l=!1},d(a){a&&(E(e),E(n)),i&&i.d(a),s=!1,o()}}}function zn(t,e,n){let{magicToken:l}=e,{limit:s=50}=e,{open:o=!1}=e,{anchorRef:i}=e,{initialStarredSites:a}=e,r=!1;const f=()=>{n(0,o=!1)};let k={},w=[],p=[],b=[],m=a,S=0,h=1,T=1,N="parent_and_child_sites",C="",I=[],A=!1,j=null;const g=()=>{n(5,h++,h),ee()},U=()=>{n(5,h=T),ee()},v=()=>{n(5,h--,h),ee()},P=()=>{n(5,h=1),ee()},V=()=>{w=[],p=m,I=[],N==="child_sites_only"?I=[{type:"parent_website",args:{value:""}}]:N==="parent_sites"&&(I=[{type:"parent_website",args:{value:"1"}}]),n(8,C=C.trim()),C!==""&&I.push({type:"name",args:{string:C,option:"contains"}}),n(5,h=1),ee()},ee=async()=>{if(n(2,A=!0),n(1,b=[]),w.length===0){const _=await ct({magicToken:l,items:I,page:h,limit:s});n(4,S=_.count),n(6,T=_.pageMax),n(5,h=T!==0?_.page:0);const y=[];if(p.forEach(R=>{const B=_.sites.findIndex(Q=>Number(Q.id)===R);if(B!==-1)k[R]=_.sites[B],_.sites.splice(B,1);else{const Q=k[R];if(!Q)y.push(R);else{const J=Q.parentSiteName.match(/^<a/);(N==="child_sites_only"&&!J||N==="parent_sites"&&J)&&(p=p.filter(fe=>fe!==R))}}}),w=[..._.sites],y.length>0){const R=await ct({magicToken:l,items:[...I,{type:"pack",args:{op:"or",items:y.map(B=>({type:"id",args:{value:B,option:"equal"}}))}}],page:0,limit:200});y.forEach(B=>{const Q=R.sites.findIndex(J=>Number(J.id)===B);Q!==-1?k[B]=R.sites[Q]:(p=p.filter(J=>J!==B),n(3,m=m.filter(J=>J!==B)))})}for(let R=0;R<s&&R<p.length;R++)b.push(k[p[R]]);for(let R=0;R<w.length&&b.length<s;R++)b.push(w[R])}else{const _=p.length,y=(h-1)*s;for(let R=y;R<_&&b.length<s;R++)b.push(k[p[R]]);for(let R=Math.max(y-_,0);R<S-_&&b.length<s;R++){if(!w[R]){const B=Math.floor(R/s),Q=await ct({magicToken:l,items:[...I,...p.map(fe=>({type:"id",args:{value:fe,option:"not_equal"}}))],page:B+1,limit:s}),J=B*s;for(let fe=0;fe<Q.sites.length;fe++)w[J+fe]=Q.sites[fe]}b.push(w[R])}}n(2,A=!1)},Z=async _=>{const y=new FormData;return y.append("__mode","save_starred_sites"),y.append("magic_token",l),_.forEach(R=>{y.append("id",String(R))}),fetch(window.ScriptURI,{method:"POST",body:y,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(R=>R.json()).then(R=>{if(R.error)throw new Error(R.error)})},te=_=>{const y=[...m];n(3,m=_),Z(m).catch(R=>{alert(R.message),n(3,m=y)})},ce=(_,y)=>{_.stopPropagation(),te([...new Set([...m,Number(y.id)])])},ne=(_,y)=>{_.stopPropagation();const R=Number(y.id);te(m.filter(B=>B!==R))},ae=_=>{const y=_.target;o&&at([i,j],y)&&f()};let F=null;const le=async()=>{await jt(),F&&jQuery(F).sortable({delay:100,distance:3,items:"tr[data-is-starred]",handle:".site-list-table-sortable-handle",opacity:.8,start(_,y){if(!F)return;const R=document.createElement("tr");R.classList.add("site-list-table-placeholder"),R.innerHTML="<td></td><td class='site-list-table-parent-site'></td><td class='site-list-table-action'></td>",F.insertBefore(R,F.firstChild),y.placeholder.height(y.item.height())},stop(){var _;(_=F?.querySelector(".site-list-table-placeholder"))===null||_===void 0||_.remove()},update:()=>{if(!F)return;const _=[],y=[];F.querySelectorAll("tr[data-site-id]").forEach(B=>{const Q=Number(B.dataset.siteId);B.dataset.isStarred&&y.push(Number(Q)),_.push(b.find(J=>Number(J.id)===Q))}),n(1,b=_);const R=m.findIndex(B=>y.includes(B));n(3,m=[...m]),m.splice(R,y.length,...y),te(m)}})},be=_=>_.key==="Enter"&&P(),de=_=>_.key==="Enter"&&v(),G=_=>_.key==="Enter"&&g(),ie=_=>_.key==="Enter"&&U();function ge(){N=Rt(this),n(7,N)}function X(){C=this.value,n(8,C)}const Ce=_=>_.key==="Enter"&&V(),se=(_,y)=>ne(y,_),K=(_,y)=>ce(y,_),O=(_,y)=>ne(y,_),ue=(_,y)=>ce(y,_);function oe(_){Re[_?"unshift":"push"](()=>{F=_,n(10,F)})}function D(_){Re[_?"unshift":"push"](()=>{j=_,n(9,j)})}return t.$$set=_=>{"magicToken"in _&&n(20,l=_.magicToken),"limit"in _&&n(21,s=_.limit),"open"in _&&n(0,o=_.open),"anchorRef"in _&&n(22,i=_.anchorRef),"initialStarredSites"in _&&n(23,a=_.initialStarredSites)},t.$$.update=()=>{t.$$.dirty[0]&20971521&&i&&(o?(i.classList.add("open"),r||(n(24,r=!0),V())):i.classList.remove("open")),t.$$.dirty[0]&7&&b&&b.length>0&&o&&!A&&le()},[o,b,A,m,S,h,T,N,C,j,F,f,g,U,v,P,V,ce,ne,ae,l,s,i,a,r,be,de,G,ie,ge,X,Ce,se,K,O,ue,oe,D]}class Gn extends Oe{constructor(e){super(),Ae(this,e,zn,Qn,Me,{magicToken:20,limit:21,open:0,anchorRef:22,initialStarredSites:23},null,[-1,-1])}}function Xn(t,e){const n=new Gn({target:t,props:e});e.anchorRef.addEventListener("click",l=>{l.preventDefault(),e.anchorRef.classList.contains("open")?e.open=!1:e.open=!0,n.$set(e)})}function Kn(t,e){var n;let l=[];if(t.dataset.searchTabsJson){const i=JSON.parse(t.dataset.searchTabsJson);i.success&&(l=i.data)}const s={searchTabs:l,objectType:(n=t.dataset.objectType)!==null&&n!==void 0?n:"",contentTypes:e.contentTypes||[],isLoading:!1,...e},o=new zt({target:t,props:s});t.closest("li[data-is='search-form-button']").addEventListener("click",i=>{i.preventDefault(),s.isLoading=!0,o.$set(s),rt({blogId:e.blogId,magicToken:e.magicToken}).then(a=>{const r=a.contentTypes.filter(f=>f.can_search===1);s.contentTypes=r,s.contentTypes.length>0&&s.objectType===""&&(s.objectType="content_data"),s.isLoading=!1,o.$set(s)}).catch(a=>{console.error("Failed to fetch content types:",a),s.isLoading=!1,o.$set(s)})},{once:!0})}var dt,ut,ft;const _t=document.querySelector('[data-is="primary-navigation-toggle"]');_t!==null&&Sn(_t,{collapsed:(dt=Ht())!==null&&dt!==void 0?dt:!1,buttonRef:_t.getElementsByTagName("button")[0]});const pt=document.querySelector('[data-script="admin-ui"]');pt===null&&console.error("data-script='admin-ui' is not set");const mt=(ut=pt?.getAttribute("data-blog-id"))!==null&&ut!==void 0?ut:"",ye=(ft=pt?.getAttribute("data-magic-token"))!==null&&ft!==void 0?ft:"";ye===""&&console.error("data-magic-token is not set");const Yn="50",xt=document.querySelectorAll('[data-is="site-list-button"]');xt.length>0&&ye!==""&&xt.forEach(t=>{var e;Xn(t,{magicToken:ye,limit:Number.parseInt(Yn),open:!1,anchorRef:t,initialStarredSites:((e=t.dataset.starredSites)===null||e===void 0?void 0:e.split(",").map(Number).filter(Number.isInteger))||[]})});const $t=document.querySelectorAll('[data-is="create-button"]'),ht=document.querySelector('[data-is="search-button"]'),Zn=document.querySelector("div.mt-modal");$t.length>0&&ye!==""&&$t.forEach(t=>{gn({target:t,props:{blog_id:mt,magicToken:ye,open:!1,anchorRef:t,containerRef:Zn}})}),ht!==null&&ye!==""&&qn(ht,{blogId:mt,magicToken:ye,open:!1,anchorRef:ht});const en=document.querySelector('[data-is="search-form"]');en!==null&&ye!==""&&Kn(en,{blogId:mt,magicToken:ye});
