const r=document.querySelector("#main-widget-container"),u=1e3,n=()=>{const t={};document.querySelectorAll(".mt-widget--resizable").forEach((e,a)=>{t[e.id]={order:u+(a+1)/1e3,size:e.classList.contains("mt-widget--half")?"half":"full"}});const i=new FormData;i.append("__mode","update_widget_prefs"),i.append("widget_action","save_layout"),i.append("xhr","1"),i.append("magic_token",r.dataset.magicToken),i.append("widget_scope",r.dataset.currentWidgetScope),i.append("widget_layout",JSON.stringify(t)),fetch(window.CMSScriptURI,{method:"POST",body:i,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(async e=>{const a=await e.json();if(a.error)throw new Error(a.error)}).catch(e=>{alert(e.message)})};let o=!1;jQuery(r).sortable({items:".mt-widget--resizable",handle:".mt-widget__title .mt-icon",tolerance:"pointer",start:()=>{o=!0},stop:()=>{o=!1},update:()=>{n()}}),document.querySelectorAll(".mt-widget--resizable").forEach(t=>{let i=!0,e;new ResizeObserver(a=>{if(i){i=!1;return}if(!o)for(const d of a)e===void 0&&window.addEventListener("mouseup",()=>{if(!e)return;const c=t.parentElement.clientWidth,l=e/c;e=void 0,setTimeout(()=>{t.style.width="";let s=!1;l>.7?t.classList.contains("mt-widget--half")&&(t.classList.remove("mt-widget--half"),s=!0):t.classList.contains("mt-widget--half")||(t.classList.add("mt-widget--half"),s=!0),s&&n()})},{once:!0,passive:!0}),e=d.contentRect.width}).observe(t)});
